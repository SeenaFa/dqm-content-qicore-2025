{
  "resourceType": "Library",
  "id": "CQMCommon",
  "meta": {
    "profile": [ "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-shareablelibrary", "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-computablelibrary", "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-publishablelibrary", "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-executablelibrary", "http://hl7.org/fhir/uv/cql/StructureDefinition/cql-library", "http://hl7.org/fhir/uv/cql/StructureDefinition/elm-json-library", "http://hl7.org/fhir/uv/cql/StructureDefinition/elm-xml-library" ]
  },
  "language": "en",
  "text": {
    "status": "extensions",
    "div": "<div xmlns=\"http://www.w3.org/1999/xhtml\" class=\"col-12\">\n  <table class=\"narrative-table\">\n    <tbody>\n<tr>\n\n\n<th colspan=\"2\" scope=\"row\" class=\"row-header\">Metadata</th>\n\n\n</tr>\n\n<tr>\n\n\n<th scope=\"row\" class=\"row-header\">Title</th>\n\n\n<td class=\"content-container\">CQMCommon</td>\n</tr>\n\n\n\n<tr>\n\n\n<th scope=\"row\" class=\"row-header\">Version</th>\n\n\n<td class=\"content-container\">4.1.000</td>\n</tr>\n\n\n\n\n\n\n\n  \n<tr>\n\n\n<th scope=\"row\" class=\"row-header\">Identifier</th>\n\n\n<td class=\"content-container\">67dda0df9e9ab93ec36dad4f</td>\n</tr>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<tr>\n\n\n<th scope=\"row\" class=\"row-header\">Steward (Publisher)</th>\n\n\n<td class=\"content-container\">ICF</td>\n</tr>\n\n\n\n\n\n\n\n<tr>\n\n\n<th scope=\"row\" class=\"row-header\">Description</th>\n\n\n<td class=\"content-container\">This library contains declarations that are commonly used in eCQMs and shared across the logic of multiple measures, such as the Encounter Inpatient value set, and the Inpatient Encounter population criteria definition. This library also contains functions for calculating hospitalization duration as well as hospital arrival and departure times.</td>\n</tr>\n\n\n\n\n\n\n<tr>\n\n\n<th scope=\"row\" class=\"row-header\">Type</th>\n\n\n<td class=\"content-container\">[http://terminology.hl7.org/CodeSystem/library-type#logic-library]</td>\n</tr>\n\n\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Location\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-location\n    <br/>        \n  \n   \n   \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Condition\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-encounter-diagnosis\n    <br/>        \n  \n   \n   \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Condition\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-problems-health-concerns\n    <br/>        \n  \n   \n   \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Encounter\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: type, status, status.value, period, rank, rank.value, use, condition, location, location.type, diagnosis, diagnosis.code, onAdmission\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: type</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Encounter\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: type, status, status.value, period, rank, rank.value, use, condition, location, location.type, diagnosis, diagnosis.code, onAdmission\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: type</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Encounter\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: type, status, status.value, period, rank, rank.value, use, condition, location, location.type, diagnosis, diagnosis.code, onAdmission\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: type</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Encounter\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: type, period, rank, rank.value, use, condition, location, location.type, diagnosis, diagnosis.code, onAdmission\n    <br/>\n   \n  \n    <em>Code Filter(s)</em>: \n    <br/>\n  \n  \n    <span class=\"tab-one\"><em>Path</em>: type</span>\n    <br/>\n  \n  \n  \n    <span class=\"tab-one\"><em>ValueSet</em>:</span> http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1110.38\n    <br/> \n  \n  \n  \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Encounter\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: period, rank, rank.value, use, condition, location, location.type, diagnosis, diagnosis.code, type, onAdmission\n    <br/>\n   \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Claim\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-claim\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: status, status.value, use, use.value, item\n    <br/>\n   \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: MedicationRequest\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medicationrequest\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: medication\n    <br/>\n   \n   \n  </td>\n</tr>\n\n<tr>\n  <th scope=\"row\" class=\"row-header\">Data Requirement</th>\n  <td class=\"content-container\">\n    <em>Type</em>: Medication\n    <br/>\n  \n    <em>Profile(s)</em>: \n  \n    http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medication\n    <br/>        \n  \n   \n   \n    <em>Must Support Elements</em>: code\n    <br/>\n   \n   \n  </td>\n</tr>\n\n\n  <tr>\n\n\n<th colspan=\"2\" scope=\"row\" class=\"row-header\">Library Content</th>\n\n\n</tr>\n  \n    \n    <tr>\n      <th scope=\"row\" class=\"row-header\">CQL Content</th>\n      <td>\n        <a name=\"cql-content\"> </a>\n        <pre style=\"border: none;\" class=\"content-container highlight language-cql\"><code class=\"language-cql\">library CQMCommon version '4.1.000'\n\nusing QICore version '6.0.0'\n\ninclude FHIRHelpers version '4.4.000' called FHIRHelpers\ninclude QICoreCommon version '4.0.000' called QICoreCommon\n\ncodesystem DiagnosisRole: 'http://terminology.hl7.org/CodeSystem/diagnosis-role'\ncodesystem &quot;Diagnosis Type&quot;: 'http://terminology.hl7.org/CodeSystem/ex-diagnosistype'\ncodesystem &quot;Procedure Type&quot;: 'http://terminology.hl7.org/CodeSystem/ex-procedure-type'\ncodesystem &quot;Present On Admission Indicators&quot;: 'https://www.cms.gov/Medicare/Medicare-Fee-for-Service-Payment/HospitalAcqCond/Coding'\n\nvalueset &quot;Emergency Department Visit&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292'\nvalueset &quot;Encounter Inpatient&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307'\nvalueset &quot;Intensive Care Unit&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1029.206'\nvalueset &quot;Observation Services&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143'\nvalueset &quot;Outpatient Surgery Service&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1110.38'\nvalueset &quot;Present on Admission or Clinically Undetermined&quot;: 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1147.197'\n\ncode &quot;Billing&quot;: 'billing' from DiagnosisRole display 'Billing'\ncode &quot;Admitting Diagnosis&quot;: 'admitting' from &quot;Diagnosis Type&quot; display 'Admitting Diagnosis'\ncode &quot;Clinical Diagnosis&quot;: 'clinical' from &quot;Diagnosis Type&quot; display 'Clinical Diagnosis'\ncode &quot;Differential Diagnosis&quot;: 'differential' from &quot;Diagnosis Type&quot; display 'Differential Diagnosis'\ncode &quot;Discharge Diagnosis&quot;: 'discharge' from &quot;Diagnosis Type&quot; display 'Discharge Diagnosis'\ncode &quot;Laboratory Diagnosis&quot;: 'laboratory' from &quot;Diagnosis Type&quot; display 'Laboratory Diagnosis'\ncode &quot;Nursing Diagnosis&quot;: 'nursing' from &quot;Diagnosis Type&quot; display 'Nursing Diagnosis'\ncode &quot;Prenatal Diagnosis&quot;: 'prenatal' from &quot;Diagnosis Type&quot; display 'Prenatal Diagnosis'\ncode &quot;Principal Diagnosis&quot;: 'principal' from &quot;Diagnosis Type&quot; display 'Principal Diagnosis'\ncode &quot;Radiology Diagnosis&quot;: 'radiology' from &quot;Diagnosis Type&quot; display 'Radiology Diagnosis'\ncode &quot;Remote Diagnosis&quot;: 'remote' from &quot;Diagnosis Type&quot; display 'Remote Diagnosis'\ncode &quot;Retrospective Diagnosis&quot;: 'retrospective' from &quot;Diagnosis Type&quot; display 'Retrospetive Diagnosis'\ncode &quot;Self Diagnosis&quot;: 'self' from &quot;Diagnosis Type&quot; display 'Self Diagnosis'\ncode &quot;Primary procedure&quot;: 'primary' from &quot;Procedure Type&quot; display 'Primary procedure'\ncode &quot;POA-Y&quot;: 'Y' from &quot;Present On Admission Indicators&quot; display 'POA-Y'\ncode &quot;POA-N&quot;: 'N' from &quot;Present On Admission Indicators&quot; display 'POA-N'\ncode &quot;POA-W&quot;: 'W' from &quot;Present On Admission Indicators&quot; display 'POA-W'\ncode &quot;POA-1&quot;: '1' from &quot;Present On Admission Indicators&quot; display 'POA-1'\ncode &quot;POA-U&quot;: 'U' from &quot;Present On Admission Indicators&quot; display 'POA-U'\n\nparameter &quot;Measurement Period&quot; Interval&lt;DateTime&gt;\n\ncontext Patient\n\ndefine &quot;Inpatient Encounter&quot;:\n  [Encounter: &quot;Encounter Inpatient&quot;] EncounterInpatient\n    where EncounterInpatient.status = 'finished'\n      and EncounterInpatient.period ends during day of &quot;Measurement Period&quot;\n\n/*\n@description: Returns an interval of date values extracted from the input interval of date-time values\n@comment: This function returns an interval constructed using the `date from` extractor on the start\nand end values of the input date-time interval. Note that using a precision specifier such as `day of`\nas part of a timing phrase is preferred to communicate intent to perform day-level comparison, as well\nas for general readability.\n*/\ndefine function &quot;ToDateInterval&quot;(period Interval&lt;DateTime&gt;):\n  Interval[date from start of period, date from end of period]\n\n/*\n@description: Calculates the difference in calendar days between the start and end of the given interval.\n@deprecated: This function in deprecated. Use the fluent function `lengthInDays()` instead.\n*/\ndefine function &quot;LengthInDays&quot;(Value Interval&lt;DateTime&gt; ):\n  difference in days between start of Value and end of Value\n\n/*\n@description: Calculates the difference in calendar days between the start and end of the given interval.\n*/\ndefine fluent function lengthInDays(Value Interval&lt;DateTime&gt; ):\n  difference in days between start of Value and end of Value\n\n/*\n@description: Returns the most recent emergency department visit, if any, that occurs 1 hour or less prior to the given encounter.\n@deprecated: This function is deprecated. Use the fluent function `edVisit()` instead.\n*/\ndefine function &quot;ED Visit&quot;(TheEncounter Encounter ):\n  Last(\n    [Encounter: &quot;Emergency Department Visit&quot;] EDVisit\n      where EDVisit.status = 'finished'\n        and EDVisit.period ends 1 hour or less on or before start of TheEncounter.period\n      sort by end of period\n    )\n\n/*\n@description: Returns the most recent emergency department visit, if any, that occurs 1 hour or less prior to the given encounter.\n*/\ndefine fluent function edVisit(TheEncounter Encounter ):\n  Last(\n    [Encounter: &quot;Emergency Department Visit&quot;] EDVisit\n      where EDVisit.status = 'finished'\n        and EDVisit.period ends 1 hour or less on or before start of TheEncounter.period\n      sort by end of period\n    )\n\n/*\n@description: Hospitalization returns the total interval for admission to discharge for the given encounter, or for the admission of any immediately prior emergency department visit to the discharge of the given encounter.\n@deprecated: This function is deprecated. Use the fluent function `hospitalization()` instead.\n*/\ndefine function &quot;Hospitalization&quot;(TheEncounter Encounter ):\n  ( &quot;ED Visit&quot;(TheEncounter) ) X\n    return\n        if X is null then TheEncounter.period\n        else Interval[start of X.period, end of TheEncounter.period)\n\n/*\n@description: Hospitalization returns the total interval for admission to discharge for the given encounter, or for the admission of any immediately prior emergency department visit to the discharge of the given encounter.\n*/\ndefine fluent function hospitalization(TheEncounter Encounter ):\n  (TheEncounter.&quot;edVisit&quot;()) X\n    return\n        if X is null then TheEncounter.period\n        else Interval[start of X.period, end of TheEncounter.period]\n\n/*\n@description: Returns list of all locations within an encounter, including locations for immediately prior ED visit.\n@deprecated: This function is deprecated. Use the fluent function `hospitalizationLocations()` instead.\n*/\ndefine function &quot;Hospitalization Locations&quot;(TheEncounter Encounter ):\n  ( &quot;ED Visit&quot;(TheEncounter) ) EDEncounter\n    return\n        if EDEncounter is null then TheEncounter.location\n        else flatten { EDEncounter.location, TheEncounter.location }\n\n/*\n@description: Returns list of all locations within an encounter, including locations for immediately prior ED visit.\n*/\ndefine fluent function hospitalizationLocations(TheEncounter Encounter ):\n  ( TheEncounter.&quot;edVisit&quot;()) EDEncounter\n    return\n        if EDEncounter is null then TheEncounter.location\n        else flatten { EDEncounter.location, TheEncounter.location }\n\n/*\n@description: Returns the length of stay in days (i.e. the number of days between admission and discharge) for the given encounter, or from the admission of any immediately prior emergency department visit to the discharge of the encounter\n@deprecated: This function is deprecated. Use the fluent function `hospitalizationLengthOfStay()` instead.\n*/\ndefine function &quot;Hospitalization Length of Stay&quot;(TheEncounter Encounter ):\n  LengthInDays(&quot;Hospitalization&quot;(TheEncounter))\n\n/*\n@description: Returns the length of stay in days (i.e. the number of days between admission and discharge) for the given encounter, or from the admission of any immediately prior emergency department visit to the discharge of the encounter\n*/\ndefine fluent function hospitalizationLengthOfStay(TheEncounter Encounter ):\n   TheEncounter.&quot;hospitalization&quot;().&quot;lengthInDays&quot;()\n\n/*\n@description: Returns admission time for an encounter or for immediately prior emergency department visit.\n@deprecated: This function is deprecated. Use the fluent function `hospitalAdmissionTime()` instead.\n*/\ndefine function &quot;Hospital Admission Time&quot;(TheEncounter Encounter ):\n  start of &quot;Hospitalization&quot;(TheEncounter)\n\n/*\n@description: Returns admission time for an encounter or for immediately prior emergency department visit.\n*/\ndefine fluent function hospitalAdmissionTime(TheEncounter Encounter ):\n  start of (TheEncounter.&quot;hospitalization&quot;())\n\n/*\n@description: Hospital Discharge Time returns the discharge time for an encounter\n@deprecated: This function is deprecated. Use the fluent function `hospitalDischargeTime()` instead.\n*/\ndefine function &quot;Hospital Discharge Time&quot;(TheEncounter Encounter ):\n  end of TheEncounter.period\n\n/*\n@description: Hospital Discharge Time returns the discharge time for an encounter\n*/\ndefine fluent function hospitalDischargeTime(TheEncounter Encounter ):\n  end of TheEncounter.period\n\n/*\n@description: Returns earliest arrival time for an encounter including any prior ED visit.\n@deprecated: This function is deprecated. Use the fluent function `hospitalArrivalTime()` instead.\n*/\ndefine function &quot;Hospital Arrival Time&quot;(TheEncounter Encounter ):\n  start of First(\n  \t    (&quot;Hospitalization Locations&quot;(TheEncounter) ) HospitalLocation\n  \t\t\tsort by start of period\n  \t).period\n\n/*\n@description: Returns earliest arrival time for an encounter including any prior ED visit.\n*/\ndefine fluent function hospitalArrivalTime(TheEncounter Encounter ):\n  start of First(\n  \t    (TheEncounter.&quot;hospitalizationLocations&quot;()) HospitalLocation\n  \t\t\tsort by start of period\n  \t).period\n\n/*\n@description: Returns the latest departure time for encounter including any prior ED visit.\n@deprecated: This function is deprecated. Use the fluent function `hospitalDepartureTime()` instead.\n*/\ndefine function &quot;Hospital Departure Time&quot;(TheEncounter Encounter):\n\tend of Last(\n\t    ( &quot;Hospitalization Locations&quot;(TheEncounter) ) HospitalLocation\n\t\t\tsort by start of period\n\t).period\n\n/*\n@description: Returns the latest departure time for encounter including any prior ED visit.\n*/\ndefine fluent function hospitalDepartureTime(TheEncounter Encounter):\n\tend of Last(\n\t    (TheEncounter.&quot;hospitalizationLocations&quot;()) HospitalLocation\n\t\t\tsort by start of period\n\t).period\n\n/*\n@description: Returns the emergency department arrival time for the encounter.\n@deprecated. This function is deprecated. Use the fluent function `emergencyDepartmentArrivalTime()` instead.\n*/\ndefine function &quot;Emergency Department Arrival Time&quot;(TheEncounter Encounter):\n\tstart of (\n\t    singleton from (\n\t        ( &quot;Hospitalization Locations&quot;(TheEncounter) ) HospitalLocation\n\t\t\t\twhere GetLocation(HospitalLocation.location).type in &quot;Emergency Department Visit&quot;\n\t\t)\n\t).period\n\n/*\n@description: Returns the emergency department arrival time for the encounter.\n*/\ndefine fluent function emergencyDepartmentArrivalTime(TheEncounter Encounter):\n\tstart of (\n\t    singleton from (\n\t        ( (TheEncounter.&quot;hospitalizationLocations&quot;()) ) HospitalLocation\n\t\t\t\twhere GetLocation(HospitalLocation.location).type in &quot;Emergency Department Visit&quot;\n\t\t)\n\t).period\n\n/*\n@description: Hospitalization with Observation and Outpatient Surgery Service returns the total interval from the start of any immediately prior emergency department visit, outpatient surgery visit or observation visit to the discharge of the given encounter.\n@deprecated: This function is deprecated. Use the fluent function `hospitalizationWithObservationAndOutpatientSurgeryService()` instead.\n*/\ndefine function &quot;HospitalizationWithObservationAndOutpatientSurgeryService&quot;(TheEncounter &quot;Encounter&quot; ):\n  TheEncounter Visit\n\t  let ObsVisit: Last([Encounter: &quot;Observation Services&quot;] LastObs\n\t\t  \twhere LastObs.status = 'finished'\n          and LastObs.period ends 1 hour or less on or before start of Visit.period\n\t\t\t  sort by\tend of period\n    \t),\n    \tVisitStart: Coalesce(start of ObsVisit.period, start of Visit.period),\n    \tEDVisit: Last([Encounter: &quot;Emergency Department Visit&quot;] LastED\n\t\t\t  where LastED.status = 'finished'\n          and LastED.period ends 1 hour or less on or before VisitStart\n\t\t\t  sort by\tend of period\n    \t),\n    \tVisitStartWithED: Coalesce(start of EDVisit.period, VisitStart),\n    \tOutpatientSurgeryVisit: Last([Encounter: &quot;Outpatient Surgery Service&quot;] LastSurgeryOP\n\t\t\t  where LastSurgeryOP.period ends 1 hour or less on or before VisitStartWithED\n\t\t\t  sort by\tend of period\n    \t)\n  \treturn Interval[Coalesce(start of OutpatientSurgeryVisit.period, VisitStartWithED), end of Visit.period]\n\n/*\n@description: Hospitalization with Observation and Outpatient Surgery Service returns the total interval from the start of any immediately prior emergency department visit, outpatient surgery visit or observation visit to the discharge of the given encounter.\n*/\ndefine fluent function hospitalizationWithObservationAndOutpatientSurgeryService(TheEncounter &quot;Encounter&quot; ):\n  TheEncounter Visit\n\t  let ObsVisit: Last([Encounter: &quot;Observation Services&quot;] LastObs\n\t\t  \twhere LastObs.status = 'finished'\n          and LastObs.period ends 1 hour or less on or before start of Visit.period\n\t\t\t  sort by\tend of period\n    \t),\n    \tVisitStart: Coalesce(start of ObsVisit.period, start of Visit.period),\n    \tEDVisit: Last([Encounter: &quot;Emergency Department Visit&quot;] LastED\n\t\t\t  where LastED.status = 'finished'\n          and LastED.period ends 1 hour or less on or before VisitStart\n\t\t\t  sort by\tend of period\n    \t),\n    \tVisitStartWithED: Coalesce(start of EDVisit.period, VisitStart),\n    \tOutpatientSurgeryVisit: Last([Encounter: &quot;Outpatient Surgery Service&quot;] LastSurgeryOP\n\t\t\t  where LastSurgeryOP.period ends 1 hour or less on or before VisitStartWithED\n\t\t\t  sort by\tend of period\n    \t)\n  \treturn Interval[Coalesce(start of OutpatientSurgeryVisit.period, VisitStartWithED), end of Visit.period]\n\n/*\n@description: Hospitalization with Observation returns the total interval from the start of any immediately prior emergency department visit through the observation visit to the discharge of the given encounter\n@deprecated: This function is deprecated. Use the fluent function `hospitalizationWithObservation()` instead.\n*/\ndefine function &quot;HospitalizationWithObservation&quot;(TheEncounter Encounter ):\n  TheEncounter Visit\n  \t\tlet ObsVisit: Last([Encounter: &quot;Observation Services&quot;] LastObs\n  \t\t\t\twhere LastObs.status = 'finished'\n            and LastObs.period ends 1 hour or less on or before start of Visit.period\n  \t\t\t\tsort by end of period\n  \t\t\t),\n  \t\t\tVisitStart: Coalesce(start of ObsVisit.period, start of Visit.period),\n  \t\t\tEDVisit: Last([Encounter: &quot;Emergency Department Visit&quot;] LastED\n  \t\t\t\twhere LastED.status = 'finished'\n            and LastED.period ends 1 hour or less on or before VisitStart\n  \t\t\t\tsort by end of period\n  \t\t\t)\n  \t\treturn Interval[Coalesce(start of EDVisit.period, VisitStart), end of Visit.period]\n\n/*\n@description: Hospitalization with Observation returns the total interval from the start of any immediately prior emergency department visit through the observation visit to the discharge of the given encounter\n*/\ndefine fluent function hospitalizationWithObservation(TheEncounter Encounter ):\n  TheEncounter Visit\n  \t\tlet ObsVisit: Last([Encounter: &quot;Observation Services&quot;] LastObs\n  \t\t\t\twhere LastObs.status = 'finished'\n            and LastObs.period ends 1 hour or less on or before start of Visit.period\n  \t\t\t\tsort by end of period\n  \t\t\t),\n  \t\t\tVisitStart: Coalesce(start of ObsVisit.period, start of Visit.period),\n  \t\t\tEDVisit: Last([Encounter: &quot;Emergency Department Visit&quot;] LastED\n  \t\t\t\twhere LastED.status = 'finished'\n            and LastED.period ends 1 hour or less on or before VisitStart\n  \t\t\t\tsort by end of period\n  \t\t\t)\n  \t\treturn Interval[Coalesce(start of EDVisit.period, VisitStart), end of Visit.period]\n\n/*\n@description: Hospitalization with Observation Length of Stay returns the length in days from the start of any immediately prior emergency department visit through the observation visit to the discharge of the given encounter\n@deprecated: This function is deprecated. Use the fluent function `hospitalizationWithObservationLengthofStay()` instead.\n*/\ndefine function &quot;HospitalizationWithObservationLengthofStay&quot;(TheEncounter &quot;Encounter&quot; ):\n  &quot;LengthInDays&quot;(&quot;HospitalizationWithObservation&quot;(TheEncounter))\n\n/*\n@description: Hospitalization with Observation Length of Stay returns the length in days from the start of any immediately prior emergency department visit through the observation visit to the discharge of the given encounter\n*/\ndefine fluent function hospitalizationWithObservationLengthofStay(TheEncounter &quot;Encounter&quot; ):\n  ((TheEncounter.&quot;hospitalizationWithObservation&quot;().&quot;lengthInDays&quot;()))\n\n/*\n@description: First Inpatient Intensive Care Unit returns the first intensive care unit for the given encounter, without considering any immediately prior emergency department visit.\n@deprecated: This function is deprecated. Use the fluent function `firstInpatientIntensiveCareUnit()` instead.\n*/\ndefine function &quot;FirstInpatientIntensiveCareUnit&quot;(Encounter Encounter ):\n  First((Encounter.location)HospitalLocation\n  \t\t\twhere GetLocation(HospitalLocation.location).type in &quot;Intensive Care Unit&quot;\n  \t\t\t\tand HospitalLocation.period during Encounter.period\n  \t\t\tsort by start of period\n  \t)\n\n/*\n@description: First Inpatient Intensive Care Unit returns the first intensive care unit for the given encounter, without considering any immediately prior emergency department visit.\n*/\ndefine fluent function firstInpatientIntensiveCareUnit(Encounter Encounter ):\n  First((Encounter.location)HospitalLocation\n  \t\t\twhere GetLocation(HospitalLocation.location).type in &quot;Intensive Care Unit&quot;\n  \t\t\t\tand HospitalLocation.period during Encounter.period\n  \t\t\tsort by start of period\n  \t)\n\n/*\n@description: Returns the Condition resource referenced by the `diagnosis.condition` element of the Encounter\n@deprecated: This function is deprecated. Use the fluent function `encounterDiagnosis()` instead.\n*/\ndefine function &quot;EncounterDiagnosis&quot;(Encounter Encounter ):\n  Encounter.diagnosis D\n\treturn singleton from (([ConditionEncounterDiagnosis] union [ConditionProblemsHealthConcerns]) C where D.condition.references(C.id))\n\n/*  \n@description: Returns the Condition resources referenced by the diagnosis element of the Encounter  \n*/\ndefine fluent function encounterDiagnosis(Encounter Encounter ):\n  Encounter.reasonReference D\n    return singleton from (([ConditionEncounterDiagnosis] union [ConditionProblemsHealthConcerns]) C where D.references(C.id))\n\n\n/*\n@description: Returns the Condition resource for the given reference\n@deprecated: This function is deprecated. Use the fluent function `getCondition()` instead\n*/\ndefine function &quot;GetCondition&quot;(reference Reference):\n  singleton from (([ConditionEncounterDiagnosis] union [ConditionProblemsHealthConcerns]) C where reference.references(C.id))\n\n/*\n@description: Returns the Condition resource for the given reference\n*/\ndefine fluent function getCondition(reference Reference):\n  singleton from (([ConditionEncounterDiagnosis] union [ConditionProblemsHealthConcerns]) C where reference.references(C.id))\n\n/*\n@description: Returns the condition that is specified as the principal diagnosis for the encounter\n@deprecated: This function is deprecated. Use the fluent function `principalDiagnosis()` instead.\n*/\ndefine function &quot;PrincipalDiagnosis&quot;(Encounter Encounter):\n\tsingleton from (\n\t(Encounter.diagnosis D where D.rank = 1 and D.use ~ &quot;Billing&quot;) PD\n      return singleton from (([ConditionEncounterDiagnosis] union [ConditionProblemsHealthConcerns]) C where PD.condition.references(C.id))\n\t)\n\n/*\n@description: Returns the claim diagnosis element that is specified as the principal diagnosis for the encounter\n @comment: See the QICore 6 Authoring Patterns discussion on [Principal Diagnosis and Present on Admission](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/wiki/Authoring-Patterns-QICore-v6.0.0#conditions-present-on-admission-and-principal-diagnoses) for more information\n*/\ndefine fluent function principalDiagnosis(encounter Encounter):\nsingleton from (\n     (encounter.claimDiagnosis()) CD\n       where CD.type.includesCode(&quot;Principal Diagnosis&quot;)\n   )\n/*\n@description: Returns the claim diagnosis elements for the given encounter\n@comment: See the QICore 6 Authoring Patterns discussion on [Principal Diagnosis and Present on Admission](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/wiki/Authoring-Patterns-QICore-v6.0.0#conditions-present-on-admission-and-principal-diagnoses) for more information\n*/\ndefine fluent function claimDiagnosis(encounter Encounter):\n  encounter E\n    let \n      claim: ([Claim] C where C.status = 'active' and C.use = 'claim' and exists (C.item I where I.encounter.references(E))),\n      claimItem: (claim.item I where I.encounter.references(E))\n    return claim.diagnosis D where D.sequence in claimItem.diagnosisSequence\n\n\n/*\n @description: Returns the condition that is specified as the principal diagnosis for the encounter and has a code in the given valueSet.\n @comment: See the QICore 6 Authoring Patterns discussion on [Principal Diagnosis and Present on Admission](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/wiki/Authoring-Patterns-QICore-v6.0.0#conditions-present-on-admission-and-principal-diagnoses) for more information\n */\n define fluent function hasPrincipalDiagnosisOf(encounter Encounter, valueSet ValueSet):\n   (encounter.principalDiagnosis()) PD\n     return PD.diagnosis in valueSet\n       or PD.diagnosis.getCondition().code in valueSet\n\n/*\n @description: Returns true if the given diagnosis is present on admission, based on the given poaValueSet\n @comment: See the QICore 6 Authoring Patterns discussion on [Principal Diagnosis and Present on Admission](https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/wiki/Authoring-Patterns-QICore-v6.0.0#conditions-present-on-admission-and-principal-diagnoses) for more information\n */\n define fluent function isDiagnosisPresentOnAdmission(encounter Encounter, diagnosisValueSet ValueSet, poaValueSet ValueSet):\n   exists (\n     (encounter.claimDiagnosis()) CD\n       where CD.onAdmission in poaValueSet\n         and (\n           CD.diagnosis in diagnosisValueSet\n             or CD.diagnosis.getCondition().code in diagnosisValueSet\n         )\n   )\n\n/*\n@description: Returns the Location resource specified by the given reference\n@deprecated: This function is deprecated. Use the fluent function `getLocation()` instead.\n*/\ndefine function &quot;GetLocation&quot;(reference Reference):\n  singleton from (\n    [Location] L where reference.references(L)\n  )\n\n/*\n@description: Returns the Location resource specified by the given reference.\n*/\ndefine fluent function getLocation(reference Reference):\n  singleton from (\n    [Location] L where reference.references(L)\n  )\n\n/*\n@description: Returns the medication code for the given MedicationRequest\n@deprecated: This function is deprecated. Use the fluent function `getMedicationCode()` instead.\n*/\ndefine function &quot;GetMedicationCode&quot;(request MedicationRequest):\n  if request.medication is Concept then\n  \t  request.medication as Concept\n  \telse\n  \t  (singleton from ([Medication] M where request.medication.references(M))).code\n\n/*\n@description: Returns the medication code for the given MedicationRequest\n*/\ndefine fluent function getMedicationCode(request MedicationRequest):\n  if request.medication is Concept then\n  \t  request.medication as Concept\n  \telse\n  \t  (singleton from ([Medication] M where request.medication.references(M))).code\n  \t  \n/*\n@description: Returns the claim procedure elements for the given encounter\n*/\ndefine fluent function principalProcedure(encounter Encounter):  \t  \n  \t encounter E\n  \t let \n        claim: [Claim] C where C.status = 'active' and C.use = 'claim' and exists (C.item I where I.encounter.references(E)),\n        claimItem: claim.item I where I.encounter.references(E),\n        princProcedure: singleton from (claim.procedure P where P.sequence in claimItem.procedureSequence and P.type.includesCode(&quot;Primary procedure&quot;))\n    return princProcedure</code></pre>\n      </td>\n    </tr>\n    \n    \n    \n  \n\n<tr>\n  <th colspan=\"2\" scope=\"row\" class=\"row-header\">Generated using version 0.4.9 of the sample-content-ig Liquid templates</th>\n</tr>\n\n    </tbody>\n  </table>\n</div>"
  },
  "contained": [ {
    "resourceType": "Parameters",
    "id": "options",
    "parameter": [ {
      "name": "translatorVersion",
      "valueString": "3.27.0"
    }, {
      "name": "option",
      "valueString": "EnableAnnotations"
    }, {
      "name": "option",
      "valueString": "EnableLocators"
    }, {
      "name": "option",
      "valueString": "EnableResultTypes"
    }, {
      "name": "option",
      "valueString": "DisableListDemotion"
    }, {
      "name": "option",
      "valueString": "DisableListPromotion"
    }, {
      "name": "format",
      "valueString": "JSON"
    }, {
      "name": "format",
      "valueString": "XML"
    }, {
      "name": "analyzeDataRequirements",
      "valueBoolean": false
    }, {
      "name": "collapseDataRequirements",
      "valueBoolean": false
    }, {
      "name": "compatibilityLevel",
      "valueString": "1.5"
    }, {
      "name": "enableCqlOnly",
      "valueBoolean": false
    }, {
      "name": "errorLevel",
      "valueString": "Info"
    }, {
      "name": "signatureLevel",
      "valueString": "All"
    }, {
      "name": "validateUnits",
      "valueBoolean": true
    }, {
      "name": "verifyOnly",
      "valueBoolean": false
    } ]
  } ],
  "extension": [ {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://terminology.hl7.org/CodeSystem/diagnosis-role",
      "code": "billing",
      "display": "Billing"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://terminology.hl7.org/CodeSystem/ex-diagnosistype",
      "code": "admitting",
      "display": "Admitting Diagnosis"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://terminology.hl7.org/CodeSystem/ex-diagnosistype",
      "code": "clinical",
      "display": "Clinical Diagnosis"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://terminology.hl7.org/CodeSystem/ex-diagnosistype",
      "code": "differential",
      "display": "Differential Diagnosis"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://terminology.hl7.org/CodeSystem/ex-diagnosistype",
      "code": "discharge",
      "display": "Discharge Diagnosis"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://terminology.hl7.org/CodeSystem/ex-diagnosistype",
      "code": "laboratory",
      "display": "Laboratory Diagnosis"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://terminology.hl7.org/CodeSystem/ex-diagnosistype",
      "code": "nursing",
      "display": "Nursing Diagnosis"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://terminology.hl7.org/CodeSystem/ex-diagnosistype",
      "code": "prenatal",
      "display": "Prenatal Diagnosis"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://terminology.hl7.org/CodeSystem/ex-diagnosistype",
      "code": "principal",
      "display": "Principal Diagnosis"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://terminology.hl7.org/CodeSystem/ex-diagnosistype",
      "code": "radiology",
      "display": "Radiology Diagnosis"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://terminology.hl7.org/CodeSystem/ex-diagnosistype",
      "code": "remote",
      "display": "Remote Diagnosis"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://terminology.hl7.org/CodeSystem/ex-diagnosistype",
      "code": "retrospective",
      "display": "Retrospective Diagnosis"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://terminology.hl7.org/CodeSystem/ex-diagnosistype",
      "code": "self",
      "display": "Self Diagnosis"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "http://terminology.hl7.org/CodeSystem/ex-procedure-type",
      "code": "primary",
      "display": "Primary procedure"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "https://www.cms.gov/Medicare/Medicare-Fee-for-Service-Payment/HospitalAcqCond/Coding",
      "code": "Y",
      "display": "POA-Y"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "https://www.cms.gov/Medicare/Medicare-Fee-for-Service-Payment/HospitalAcqCond/Coding",
      "code": "N",
      "display": "POA-N"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "https://www.cms.gov/Medicare/Medicare-Fee-for-Service-Payment/HospitalAcqCond/Coding",
      "code": "W",
      "display": "POA-W"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "https://www.cms.gov/Medicare/Medicare-Fee-for-Service-Payment/HospitalAcqCond/Coding",
      "code": "1",
      "display": "POA-1"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-directReferenceCode",
    "valueCoding": {
      "system": "https://www.cms.gov/Medicare/Medicare-Fee-for-Service-Payment/HospitalAcqCond/Coding",
      "code": "U",
      "display": "POA-U"
    }
  }, {
    "url": "http://hl7.org/fhir/StructureDefinition/cqf-cqlOptions",
    "valueReference": {
      "reference": "#options"
    }
  }, {
    "url": "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-softwaresystem",
    "valueReference": {
      "reference": "Device/cqf-tooling"
    }
  } ],
  "url": "https://madie.cms.gov/Library/CQMCommon",
  "identifier": [ {
    "use": "official",
    "system": "https://madie.cms.gov/login",
    "value": "67dda0df9e9ab93ec36dad4f"
  } ],
  "version": "4.1.000",
  "name": "CQMCommon",
  "title": "CQMCommon",
  "status": "active",
  "experimental": false,
  "type": {
    "coding": [ {
      "system": "http://terminology.hl7.org/CodeSystem/library-type",
      "code": "logic-library"
    } ]
  },
  "date": "2025-10-02T13:51:39+00:00",
  "publisher": "ICF",
  "description": "This library contains declarations that are commonly used in eCQMs and shared across the logic of multiple measures, such as the Encounter Inpatient value set, and the Inpatient Encounter population criteria definition. This library also contains functions for calculating hospitalization duration as well as hospital arrival and departure times.",
  "relatedArtifact": [ {
    "type": "depends-on",
    "display": "Library FHIRHelpers",
    "resource": "https://madie.cms.gov/Library/FHIRHelpers|4.4.000"
  }, {
    "type": "depends-on",
    "display": "Library QICoreCommon",
    "resource": "https://madie.cms.gov/Library/QICoreCommon|4.0.000"
  }, {
    "type": "depends-on",
    "display": "Code system DiagnosisRole",
    "resource": "http://terminology.hl7.org/CodeSystem/diagnosis-role"
  }, {
    "type": "depends-on",
    "display": "Code system Diagnosis Type",
    "resource": "http://terminology.hl7.org/CodeSystem/ex-diagnosistype"
  }, {
    "type": "depends-on",
    "display": "Code system Procedure Type",
    "resource": "http://terminology.hl7.org/CodeSystem/ex-procedure-type"
  }, {
    "type": "depends-on",
    "display": "Code system Present On Admission Indicators",
    "resource": "https://www.cms.gov/Medicare/Medicare-Fee-for-Service-Payment/HospitalAcqCond/Coding"
  }, {
    "type": "depends-on",
    "display": "Value set Emergency Department Visit",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292"
  }, {
    "type": "depends-on",
    "display": "Value set Encounter Inpatient",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307"
  }, {
    "type": "depends-on",
    "display": "Value set Intensive Care Unit",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1029.206"
  }, {
    "type": "depends-on",
    "display": "Value set Observation Services",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143"
  }, {
    "type": "depends-on",
    "display": "Value set Outpatient Surgery Service",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1110.38"
  }, {
    "type": "depends-on",
    "display": "Value set Present on Admission or Clinically Undetermined",
    "resource": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1147.197"
  } ],
  "parameter": [ {
    "name": "Measurement Period",
    "use": "in",
    "min": 0,
    "max": "1",
    "type": "Period"
  }, {
    "name": "Patient",
    "use": "out",
    "min": 0,
    "max": "1",
    "type": "Resource"
  }, {
    "name": "Inpatient Encounter",
    "use": "out",
    "min": 0,
    "max": "*",
    "type": "Resource"
  } ],
  "dataRequirement": [ {
    "type": "Patient",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-patient" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "period" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "period" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "period" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "period" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "period" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "period" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "period" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "period" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "period" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "period" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "location" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "location" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "location" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "location" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "period" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "period" ]
  }, {
    "type": "Location",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-location" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1110.38"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1110.38"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1110.38"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1110.38"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113762.1.4.1111.143"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "type", "status", "status.value", "period" ],
    "codeFilter": [ {
      "path": "type",
      "valueSet": "http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.117.1.7.1.292"
    } ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "location" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "period" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "location" ]
  }, {
    "type": "Encounter",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter" ],
    "mustSupport": [ "period" ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-encounter-diagnosis" ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-problems-health-concerns" ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-encounter-diagnosis" ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-problems-health-concerns" ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-encounter-diagnosis" ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-problems-health-concerns" ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-encounter-diagnosis" ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-problems-health-concerns" ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-encounter-diagnosis" ]
  }, {
    "type": "Condition",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition-problems-health-concerns" ]
  }, {
    "type": "Claim",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-claim" ],
    "mustSupport": [ "status", "status.value", "use", "use.value", "item" ]
  }, {
    "type": "Claim",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-claim" ],
    "mustSupport": [ "status", "status.value", "use", "use.value", "item" ]
  }, {
    "type": "Location",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-location" ]
  }, {
    "type": "MedicationRequest",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medicationrequest" ],
    "mustSupport": [ "medication" ]
  }, {
    "type": "MedicationRequest",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medicationrequest" ],
    "mustSupport": [ "medication" ]
  }, {
    "type": "Medication",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medication" ]
  }, {
    "type": "MedicationRequest",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medicationrequest" ],
    "mustSupport": [ "medication" ]
  }, {
    "type": "Medication",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medication" ],
    "mustSupport": [ "code" ]
  }, {
    "type": "MedicationRequest",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medicationrequest" ],
    "mustSupport": [ "medication" ]
  }, {
    "type": "MedicationRequest",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medicationrequest" ],
    "mustSupport": [ "medication" ]
  }, {
    "type": "Medication",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medication" ]
  }, {
    "type": "MedicationRequest",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medicationrequest" ],
    "mustSupport": [ "medication" ]
  }, {
    "type": "Medication",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medication" ],
    "mustSupport": [ "code" ]
  }, {
    "type": "Claim",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-claim" ],
    "mustSupport": [ "status", "status.value", "use", "use.value", "item" ]
  }, {
    "type": "Claim",
    "profile": [ "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-claim" ],
    "mustSupport": [ "status", "status.value", "use", "use.value", "item" ]
  } ],
  "content": [ {
    "contentType": "text/cql",
    "data": "bGlicmFyeSBDUU1Db21tb24gdmVyc2lvbiAnNC4xLjAwMCcNCg0KdXNpbmcgUUlDb3JlIHZlcnNpb24gJzYuMC4wJw0KDQppbmNsdWRlIEZISVJIZWxwZXJzIHZlcnNpb24gJzQuNC4wMDAnIGNhbGxlZCBGSElSSGVscGVycw0KaW5jbHVkZSBRSUNvcmVDb21tb24gdmVyc2lvbiAnNC4wLjAwMCcgY2FsbGVkIFFJQ29yZUNvbW1vbg0KDQpjb2Rlc3lzdGVtIERpYWdub3Npc1JvbGU6ICdodHRwOi8vdGVybWlub2xvZ3kuaGw3Lm9yZy9Db2RlU3lzdGVtL2RpYWdub3Npcy1yb2xlJw0KY29kZXN5c3RlbSAiRGlhZ25vc2lzIFR5cGUiOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9leC1kaWFnbm9zaXN0eXBlJw0KY29kZXN5c3RlbSAiUHJvY2VkdXJlIFR5cGUiOiAnaHR0cDovL3Rlcm1pbm9sb2d5LmhsNy5vcmcvQ29kZVN5c3RlbS9leC1wcm9jZWR1cmUtdHlwZScNCmNvZGVzeXN0ZW0gIlByZXNlbnQgT24gQWRtaXNzaW9uIEluZGljYXRvcnMiOiAnaHR0cHM6Ly93d3cuY21zLmdvdi9NZWRpY2FyZS9NZWRpY2FyZS1GZWUtZm9yLVNlcnZpY2UtUGF5bWVudC9Ib3NwaXRhbEFjcUNvbmQvQ29kaW5nJw0KDQp2YWx1ZXNldCAiRW1lcmdlbmN5IERlcGFydG1lbnQgVmlzaXQiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzODgzLjMuMTE3LjEuNy4xLjI5MicNCnZhbHVlc2V0ICJFbmNvdW50ZXIgSW5wYXRpZW50IjogJ2h0dHA6Ly9jdHMubmxtLm5paC5nb3YvZmhpci9WYWx1ZVNldC8yLjE2Ljg0MC4xLjExMzg4My4zLjY2Ni41LjMwNycNCnZhbHVlc2V0ICJJbnRlbnNpdmUgQ2FyZSBVbml0IjogJ2h0dHA6Ly9jdHMubmxtLm5paC5nb3YvZmhpci9WYWx1ZVNldC8yLjE2Ljg0MC4xLjExMzc2Mi4xLjQuMTAyOS4yMDYnDQp2YWx1ZXNldCAiT2JzZXJ2YXRpb24gU2VydmljZXMiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzNzYyLjEuNC4xMTExLjE0MycNCnZhbHVlc2V0ICJPdXRwYXRpZW50IFN1cmdlcnkgU2VydmljZSI6ICdodHRwOi8vY3RzLm5sbS5uaWguZ292L2ZoaXIvVmFsdWVTZXQvMi4xNi44NDAuMS4xMTM3NjIuMS40LjExMTAuMzgnDQp2YWx1ZXNldCAiUHJlc2VudCBvbiBBZG1pc3Npb24gb3IgQ2xpbmljYWxseSBVbmRldGVybWluZWQiOiAnaHR0cDovL2N0cy5ubG0ubmloLmdvdi9maGlyL1ZhbHVlU2V0LzIuMTYuODQwLjEuMTEzNzYyLjEuNC4xMTQ3LjE5NycNCg0KY29kZSAiQmlsbGluZyI6ICdiaWxsaW5nJyBmcm9tIERpYWdub3Npc1JvbGUgZGlzcGxheSAnQmlsbGluZycNCmNvZGUgIkFkbWl0dGluZyBEaWFnbm9zaXMiOiAnYWRtaXR0aW5nJyBmcm9tICJEaWFnbm9zaXMgVHlwZSIgZGlzcGxheSAnQWRtaXR0aW5nIERpYWdub3NpcycNCmNvZGUgIkNsaW5pY2FsIERpYWdub3NpcyI6ICdjbGluaWNhbCcgZnJvbSAiRGlhZ25vc2lzIFR5cGUiIGRpc3BsYXkgJ0NsaW5pY2FsIERpYWdub3NpcycNCmNvZGUgIkRpZmZlcmVudGlhbCBEaWFnbm9zaXMiOiAnZGlmZmVyZW50aWFsJyBmcm9tICJEaWFnbm9zaXMgVHlwZSIgZGlzcGxheSAnRGlmZmVyZW50aWFsIERpYWdub3NpcycNCmNvZGUgIkRpc2NoYXJnZSBEaWFnbm9zaXMiOiAnZGlzY2hhcmdlJyBmcm9tICJEaWFnbm9zaXMgVHlwZSIgZGlzcGxheSAnRGlzY2hhcmdlIERpYWdub3NpcycNCmNvZGUgIkxhYm9yYXRvcnkgRGlhZ25vc2lzIjogJ2xhYm9yYXRvcnknIGZyb20gIkRpYWdub3NpcyBUeXBlIiBkaXNwbGF5ICdMYWJvcmF0b3J5IERpYWdub3NpcycNCmNvZGUgIk51cnNpbmcgRGlhZ25vc2lzIjogJ251cnNpbmcnIGZyb20gIkRpYWdub3NpcyBUeXBlIiBkaXNwbGF5ICdOdXJzaW5nIERpYWdub3NpcycNCmNvZGUgIlByZW5hdGFsIERpYWdub3NpcyI6ICdwcmVuYXRhbCcgZnJvbSAiRGlhZ25vc2lzIFR5cGUiIGRpc3BsYXkgJ1ByZW5hdGFsIERpYWdub3NpcycNCmNvZGUgIlByaW5jaXBhbCBEaWFnbm9zaXMiOiAncHJpbmNpcGFsJyBmcm9tICJEaWFnbm9zaXMgVHlwZSIgZGlzcGxheSAnUHJpbmNpcGFsIERpYWdub3NpcycNCmNvZGUgIlJhZGlvbG9neSBEaWFnbm9zaXMiOiAncmFkaW9sb2d5JyBmcm9tICJEaWFnbm9zaXMgVHlwZSIgZGlzcGxheSAnUmFkaW9sb2d5IERpYWdub3NpcycNCmNvZGUgIlJlbW90ZSBEaWFnbm9zaXMiOiAncmVtb3RlJyBmcm9tICJEaWFnbm9zaXMgVHlwZSIgZGlzcGxheSAnUmVtb3RlIERpYWdub3NpcycNCmNvZGUgIlJldHJvc3BlY3RpdmUgRGlhZ25vc2lzIjogJ3JldHJvc3BlY3RpdmUnIGZyb20gIkRpYWdub3NpcyBUeXBlIiBkaXNwbGF5ICdSZXRyb3NwZXRpdmUgRGlhZ25vc2lzJw0KY29kZSAiU2VsZiBEaWFnbm9zaXMiOiAnc2VsZicgZnJvbSAiRGlhZ25vc2lzIFR5cGUiIGRpc3BsYXkgJ1NlbGYgRGlhZ25vc2lzJw0KY29kZSAiUHJpbWFyeSBwcm9jZWR1cmUiOiAncHJpbWFyeScgZnJvbSAiUHJvY2VkdXJlIFR5cGUiIGRpc3BsYXkgJ1ByaW1hcnkgcHJvY2VkdXJlJw0KY29kZSAiUE9BLVkiOiAnWScgZnJvbSAiUHJlc2VudCBPbiBBZG1pc3Npb24gSW5kaWNhdG9ycyIgZGlzcGxheSAnUE9BLVknDQpjb2RlICJQT0EtTiI6ICdOJyBmcm9tICJQcmVzZW50IE9uIEFkbWlzc2lvbiBJbmRpY2F0b3JzIiBkaXNwbGF5ICdQT0EtTicNCmNvZGUgIlBPQS1XIjogJ1cnIGZyb20gIlByZXNlbnQgT24gQWRtaXNzaW9uIEluZGljYXRvcnMiIGRpc3BsYXkgJ1BPQS1XJw0KY29kZSAiUE9BLTEiOiAnMScgZnJvbSAiUHJlc2VudCBPbiBBZG1pc3Npb24gSW5kaWNhdG9ycyIgZGlzcGxheSAnUE9BLTEnDQpjb2RlICJQT0EtVSI6ICdVJyBmcm9tICJQcmVzZW50IE9uIEFkbWlzc2lvbiBJbmRpY2F0b3JzIiBkaXNwbGF5ICdQT0EtVScNCg0KcGFyYW1ldGVyICJNZWFzdXJlbWVudCBQZXJpb2QiIEludGVydmFsPERhdGVUaW1lPg0KICBkZWZhdWx0IEludGVydmFsW0AyMDI2LTAxLTAxVDAwOjAwOjAwLjAwMFosIEAyMDI3LTAxLTAxVDAwOjAwOjAwLjAwMFopDQoNCmNvbnRleHQgUGF0aWVudA0KDQpkZWZpbmUgIklucGF0aWVudCBFbmNvdW50ZXIiOg0KICBbRW5jb3VudGVyOiAiRW5jb3VudGVyIElucGF0aWVudCJdIEVuY291bnRlcklucGF0aWVudA0KICAgIHdoZXJlIEVuY291bnRlcklucGF0aWVudC5zdGF0dXMgPSAnZmluaXNoZWQnDQogICAgICBhbmQgRW5jb3VudGVySW5wYXRpZW50LnBlcmlvZCBlbmRzIGR1cmluZyBkYXkgb2YgIk1lYXN1cmVtZW50IFBlcmlvZCINCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyBhbiBpbnRlcnZhbCBvZiBkYXRlIHZhbHVlcyBleHRyYWN0ZWQgZnJvbSB0aGUgaW5wdXQgaW50ZXJ2YWwgb2YgZGF0ZS10aW1lIHZhbHVlcw0KQGNvbW1lbnQ6IFRoaXMgZnVuY3Rpb24gcmV0dXJucyBhbiBpbnRlcnZhbCBjb25zdHJ1Y3RlZCB1c2luZyB0aGUgYGRhdGUgZnJvbWAgZXh0cmFjdG9yIG9uIHRoZSBzdGFydA0KYW5kIGVuZCB2YWx1ZXMgb2YgdGhlIGlucHV0IGRhdGUtdGltZSBpbnRlcnZhbC4gTm90ZSB0aGF0IHVzaW5nIGEgcHJlY2lzaW9uIHNwZWNpZmllciBzdWNoIGFzIGBkYXkgb2ZgDQphcyBwYXJ0IG9mIGEgdGltaW5nIHBocmFzZSBpcyBwcmVmZXJyZWQgdG8gY29tbXVuaWNhdGUgaW50ZW50IHRvIHBlcmZvcm0gZGF5LWxldmVsIGNvbXBhcmlzb24sIGFzIHdlbGwNCmFzIGZvciBnZW5lcmFsIHJlYWRhYmlsaXR5Lg0KKi8NCmRlZmluZSBmdW5jdGlvbiAiVG9EYXRlSW50ZXJ2YWwiKHBlcmlvZCBJbnRlcnZhbDxEYXRlVGltZT4pOg0KICBJbnRlcnZhbFtkYXRlIGZyb20gc3RhcnQgb2YgcGVyaW9kLCBkYXRlIGZyb20gZW5kIG9mIHBlcmlvZF0NCg0KLyoNCkBkZXNjcmlwdGlvbjogQ2FsY3VsYXRlcyB0aGUgZGlmZmVyZW5jZSBpbiBjYWxlbmRhciBkYXlzIGJldHdlZW4gdGhlIHN0YXJ0IGFuZCBlbmQgb2YgdGhlIGdpdmVuIGludGVydmFsLg0KQGRlcHJlY2F0ZWQ6IFRoaXMgZnVuY3Rpb24gaW4gZGVwcmVjYXRlZC4gVXNlIHRoZSBmbHVlbnQgZnVuY3Rpb24gYGxlbmd0aEluRGF5cygpYCBpbnN0ZWFkLg0KKi8NCmRlZmluZSBmdW5jdGlvbiAiTGVuZ3RoSW5EYXlzIihWYWx1ZSBJbnRlcnZhbDxEYXRlVGltZT4gKToNCiAgZGlmZmVyZW5jZSBpbiBkYXlzIGJldHdlZW4gc3RhcnQgb2YgVmFsdWUgYW5kIGVuZCBvZiBWYWx1ZQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBDYWxjdWxhdGVzIHRoZSBkaWZmZXJlbmNlIGluIGNhbGVuZGFyIGRheXMgYmV0d2VlbiB0aGUgc3RhcnQgYW5kIGVuZCBvZiB0aGUgZ2l2ZW4gaW50ZXJ2YWwuDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBsZW5ndGhJbkRheXMoVmFsdWUgSW50ZXJ2YWw8RGF0ZVRpbWU+ICk6DQogIGRpZmZlcmVuY2UgaW4gZGF5cyBiZXR3ZWVuIHN0YXJ0IG9mIFZhbHVlIGFuZCBlbmQgb2YgVmFsdWUNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0aGUgbW9zdCByZWNlbnQgZW1lcmdlbmN5IGRlcGFydG1lbnQgdmlzaXQsIGlmIGFueSwgdGhhdCBvY2N1cnMgMSBob3VyIG9yIGxlc3MgcHJpb3IgdG8gdGhlIGdpdmVuIGVuY291bnRlci4NCkBkZXByZWNhdGVkOiBUaGlzIGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQuIFVzZSB0aGUgZmx1ZW50IGZ1bmN0aW9uIGBlZFZpc2l0KClgIGluc3RlYWQuDQoqLw0KZGVmaW5lIGZ1bmN0aW9uICJFRCBWaXNpdCIoVGhlRW5jb3VudGVyIEVuY291bnRlciApOg0KICBMYXN0KA0KICAgIFtFbmNvdW50ZXI6ICJFbWVyZ2VuY3kgRGVwYXJ0bWVudCBWaXNpdCJdIEVEVmlzaXQNCiAgICAgIHdoZXJlIEVEVmlzaXQuc3RhdHVzID0gJ2ZpbmlzaGVkJw0KICAgICAgICBhbmQgRURWaXNpdC5wZXJpb2QgZW5kcyAxIGhvdXIgb3IgbGVzcyBvbiBvciBiZWZvcmUgc3RhcnQgb2YgVGhlRW5jb3VudGVyLnBlcmlvZA0KICAgICAgc29ydCBieSBlbmQgb2YgcGVyaW9kDQogICAgKQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRoZSBtb3N0IHJlY2VudCBlbWVyZ2VuY3kgZGVwYXJ0bWVudCB2aXNpdCwgaWYgYW55LCB0aGF0IG9jY3VycyAxIGhvdXIgb3IgbGVzcyBwcmlvciB0byB0aGUgZ2l2ZW4gZW5jb3VudGVyLg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gZWRWaXNpdChUaGVFbmNvdW50ZXIgRW5jb3VudGVyICk6DQogIExhc3QoDQogICAgW0VuY291bnRlcjogIkVtZXJnZW5jeSBEZXBhcnRtZW50IFZpc2l0Il0gRURWaXNpdA0KICAgICAgd2hlcmUgRURWaXNpdC5zdGF0dXMgPSAnZmluaXNoZWQnDQogICAgICAgIGFuZCBFRFZpc2l0LnBlcmlvZCBlbmRzIDEgaG91ciBvciBsZXNzIG9uIG9yIGJlZm9yZSBzdGFydCBvZiBUaGVFbmNvdW50ZXIucGVyaW9kDQogICAgICBzb3J0IGJ5IGVuZCBvZiBwZXJpb2QNCiAgICApDQoNCi8qDQpAZGVzY3JpcHRpb246IEhvc3BpdGFsaXphdGlvbiByZXR1cm5zIHRoZSB0b3RhbCBpbnRlcnZhbCBmb3IgYWRtaXNzaW9uIHRvIGRpc2NoYXJnZSBmb3IgdGhlIGdpdmVuIGVuY291bnRlciwgb3IgZm9yIHRoZSBhZG1pc3Npb24gb2YgYW55IGltbWVkaWF0ZWx5IHByaW9yIGVtZXJnZW5jeSBkZXBhcnRtZW50IHZpc2l0IHRvIHRoZSBkaXNjaGFyZ2Ugb2YgdGhlIGdpdmVuIGVuY291bnRlci4NCkBkZXByZWNhdGVkOiBUaGlzIGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQuIFVzZSB0aGUgZmx1ZW50IGZ1bmN0aW9uIGBob3NwaXRhbGl6YXRpb24oKWAgaW5zdGVhZC4NCiovDQpkZWZpbmUgZnVuY3Rpb24gIkhvc3BpdGFsaXphdGlvbiIoVGhlRW5jb3VudGVyIEVuY291bnRlciApOg0KICAoICJFRCBWaXNpdCIoVGhlRW5jb3VudGVyKSApIFgNCiAgICByZXR1cm4NCiAgICAgICAgaWYgWCBpcyBudWxsIHRoZW4gVGhlRW5jb3VudGVyLnBlcmlvZA0KICAgICAgICBlbHNlIEludGVydmFsW3N0YXJ0IG9mIFgucGVyaW9kLCBlbmQgb2YgVGhlRW5jb3VudGVyLnBlcmlvZCkNCg0KLyoNCkBkZXNjcmlwdGlvbjogSG9zcGl0YWxpemF0aW9uIHJldHVybnMgdGhlIHRvdGFsIGludGVydmFsIGZvciBhZG1pc3Npb24gdG8gZGlzY2hhcmdlIGZvciB0aGUgZ2l2ZW4gZW5jb3VudGVyLCBvciBmb3IgdGhlIGFkbWlzc2lvbiBvZiBhbnkgaW1tZWRpYXRlbHkgcHJpb3IgZW1lcmdlbmN5IGRlcGFydG1lbnQgdmlzaXQgdG8gdGhlIGRpc2NoYXJnZSBvZiB0aGUgZ2l2ZW4gZW5jb3VudGVyLg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaG9zcGl0YWxpemF0aW9uKFRoZUVuY291bnRlciBFbmNvdW50ZXIgKToNCiAgKFRoZUVuY291bnRlci4iZWRWaXNpdCIoKSkgWA0KICAgIHJldHVybg0KICAgICAgICBpZiBYIGlzIG51bGwgdGhlbiBUaGVFbmNvdW50ZXIucGVyaW9kDQogICAgICAgIGVsc2UgSW50ZXJ2YWxbc3RhcnQgb2YgWC5wZXJpb2QsIGVuZCBvZiBUaGVFbmNvdW50ZXIucGVyaW9kXQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIGxpc3Qgb2YgYWxsIGxvY2F0aW9ucyB3aXRoaW4gYW4gZW5jb3VudGVyLCBpbmNsdWRpbmcgbG9jYXRpb25zIGZvciBpbW1lZGlhdGVseSBwcmlvciBFRCB2aXNpdC4NCkBkZXByZWNhdGVkOiBUaGlzIGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQuIFVzZSB0aGUgZmx1ZW50IGZ1bmN0aW9uIGBob3NwaXRhbGl6YXRpb25Mb2NhdGlvbnMoKWAgaW5zdGVhZC4NCiovDQpkZWZpbmUgZnVuY3Rpb24gIkhvc3BpdGFsaXphdGlvbiBMb2NhdGlvbnMiKFRoZUVuY291bnRlciBFbmNvdW50ZXIgKToNCiAgKCAiRUQgVmlzaXQiKFRoZUVuY291bnRlcikgKSBFREVuY291bnRlcg0KICAgIHJldHVybg0KICAgICAgICBpZiBFREVuY291bnRlciBpcyBudWxsIHRoZW4gVGhlRW5jb3VudGVyLmxvY2F0aW9uDQogICAgICAgIGVsc2UgZmxhdHRlbiB7IEVERW5jb3VudGVyLmxvY2F0aW9uLCBUaGVFbmNvdW50ZXIubG9jYXRpb24gfQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIGxpc3Qgb2YgYWxsIGxvY2F0aW9ucyB3aXRoaW4gYW4gZW5jb3VudGVyLCBpbmNsdWRpbmcgbG9jYXRpb25zIGZvciBpbW1lZGlhdGVseSBwcmlvciBFRCB2aXNpdC4NCiovDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGhvc3BpdGFsaXphdGlvbkxvY2F0aW9ucyhUaGVFbmNvdW50ZXIgRW5jb3VudGVyICk6DQogICggVGhlRW5jb3VudGVyLiJlZFZpc2l0IigpKSBFREVuY291bnRlcg0KICAgIHJldHVybg0KICAgICAgICBpZiBFREVuY291bnRlciBpcyBudWxsIHRoZW4gVGhlRW5jb3VudGVyLmxvY2F0aW9uDQogICAgICAgIGVsc2UgZmxhdHRlbiB7IEVERW5jb3VudGVyLmxvY2F0aW9uLCBUaGVFbmNvdW50ZXIubG9jYXRpb24gfQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRoZSBsZW5ndGggb2Ygc3RheSBpbiBkYXlzIChpLmUuIHRoZSBudW1iZXIgb2YgZGF5cyBiZXR3ZWVuIGFkbWlzc2lvbiBhbmQgZGlzY2hhcmdlKSBmb3IgdGhlIGdpdmVuIGVuY291bnRlciwgb3IgZnJvbSB0aGUgYWRtaXNzaW9uIG9mIGFueSBpbW1lZGlhdGVseSBwcmlvciBlbWVyZ2VuY3kgZGVwYXJ0bWVudCB2aXNpdCB0byB0aGUgZGlzY2hhcmdlIG9mIHRoZSBlbmNvdW50ZXINCkBkZXByZWNhdGVkOiBUaGlzIGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQuIFVzZSB0aGUgZmx1ZW50IGZ1bmN0aW9uIGBob3NwaXRhbGl6YXRpb25MZW5ndGhPZlN0YXkoKWAgaW5zdGVhZC4NCiovDQpkZWZpbmUgZnVuY3Rpb24gIkhvc3BpdGFsaXphdGlvbiBMZW5ndGggb2YgU3RheSIoVGhlRW5jb3VudGVyIEVuY291bnRlciApOg0KICBMZW5ndGhJbkRheXMoIkhvc3BpdGFsaXphdGlvbiIoVGhlRW5jb3VudGVyKSkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0aGUgbGVuZ3RoIG9mIHN0YXkgaW4gZGF5cyAoaS5lLiB0aGUgbnVtYmVyIG9mIGRheXMgYmV0d2VlbiBhZG1pc3Npb24gYW5kIGRpc2NoYXJnZSkgZm9yIHRoZSBnaXZlbiBlbmNvdW50ZXIsIG9yIGZyb20gdGhlIGFkbWlzc2lvbiBvZiBhbnkgaW1tZWRpYXRlbHkgcHJpb3IgZW1lcmdlbmN5IGRlcGFydG1lbnQgdmlzaXQgdG8gdGhlIGRpc2NoYXJnZSBvZiB0aGUgZW5jb3VudGVyDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBob3NwaXRhbGl6YXRpb25MZW5ndGhPZlN0YXkoVGhlRW5jb3VudGVyIEVuY291bnRlciApOg0KICAgVGhlRW5jb3VudGVyLiJob3NwaXRhbGl6YXRpb24iKCkuImxlbmd0aEluRGF5cyIoKQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIGFkbWlzc2lvbiB0aW1lIGZvciBhbiBlbmNvdW50ZXIgb3IgZm9yIGltbWVkaWF0ZWx5IHByaW9yIGVtZXJnZW5jeSBkZXBhcnRtZW50IHZpc2l0Lg0KQGRlcHJlY2F0ZWQ6IFRoaXMgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZC4gVXNlIHRoZSBmbHVlbnQgZnVuY3Rpb24gYGhvc3BpdGFsQWRtaXNzaW9uVGltZSgpYCBpbnN0ZWFkLg0KKi8NCmRlZmluZSBmdW5jdGlvbiAiSG9zcGl0YWwgQWRtaXNzaW9uIFRpbWUiKFRoZUVuY291bnRlciBFbmNvdW50ZXIgKToNCiAgc3RhcnQgb2YgIkhvc3BpdGFsaXphdGlvbiIoVGhlRW5jb3VudGVyKQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIGFkbWlzc2lvbiB0aW1lIGZvciBhbiBlbmNvdW50ZXIgb3IgZm9yIGltbWVkaWF0ZWx5IHByaW9yIGVtZXJnZW5jeSBkZXBhcnRtZW50IHZpc2l0Lg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaG9zcGl0YWxBZG1pc3Npb25UaW1lKFRoZUVuY291bnRlciBFbmNvdW50ZXIgKToNCiAgc3RhcnQgb2YgKFRoZUVuY291bnRlci4iaG9zcGl0YWxpemF0aW9uIigpKQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBIb3NwaXRhbCBEaXNjaGFyZ2UgVGltZSByZXR1cm5zIHRoZSBkaXNjaGFyZ2UgdGltZSBmb3IgYW4gZW5jb3VudGVyDQpAZGVwcmVjYXRlZDogVGhpcyBmdW5jdGlvbiBpcyBkZXByZWNhdGVkLiBVc2UgdGhlIGZsdWVudCBmdW5jdGlvbiBgaG9zcGl0YWxEaXNjaGFyZ2VUaW1lKClgIGluc3RlYWQuDQoqLw0KZGVmaW5lIGZ1bmN0aW9uICJIb3NwaXRhbCBEaXNjaGFyZ2UgVGltZSIoVGhlRW5jb3VudGVyIEVuY291bnRlciApOg0KICBlbmQgb2YgVGhlRW5jb3VudGVyLnBlcmlvZA0KDQovKg0KQGRlc2NyaXB0aW9uOiBIb3NwaXRhbCBEaXNjaGFyZ2UgVGltZSByZXR1cm5zIHRoZSBkaXNjaGFyZ2UgdGltZSBmb3IgYW4gZW5jb3VudGVyDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBob3NwaXRhbERpc2NoYXJnZVRpbWUoVGhlRW5jb3VudGVyIEVuY291bnRlciApOg0KICBlbmQgb2YgVGhlRW5jb3VudGVyLnBlcmlvZA0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIGVhcmxpZXN0IGFycml2YWwgdGltZSBmb3IgYW4gZW5jb3VudGVyIGluY2x1ZGluZyBhbnkgcHJpb3IgRUQgdmlzaXQuDQpAZGVwcmVjYXRlZDogVGhpcyBmdW5jdGlvbiBpcyBkZXByZWNhdGVkLiBVc2UgdGhlIGZsdWVudCBmdW5jdGlvbiBgaG9zcGl0YWxBcnJpdmFsVGltZSgpYCBpbnN0ZWFkLg0KKi8NCmRlZmluZSBmdW5jdGlvbiAiSG9zcGl0YWwgQXJyaXZhbCBUaW1lIihUaGVFbmNvdW50ZXIgRW5jb3VudGVyICk6DQogIHN0YXJ0IG9mIEZpcnN0KA0KICAJICAgICgiSG9zcGl0YWxpemF0aW9uIExvY2F0aW9ucyIoVGhlRW5jb3VudGVyKSApIEhvc3BpdGFsTG9jYXRpb24NCiAgCQkJc29ydCBieSBzdGFydCBvZiBwZXJpb2QNCiAgCSkucGVyaW9kDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgZWFybGllc3QgYXJyaXZhbCB0aW1lIGZvciBhbiBlbmNvdW50ZXIgaW5jbHVkaW5nIGFueSBwcmlvciBFRCB2aXNpdC4NCiovDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGhvc3BpdGFsQXJyaXZhbFRpbWUoVGhlRW5jb3VudGVyIEVuY291bnRlciApOg0KICBzdGFydCBvZiBGaXJzdCgNCiAgCSAgICAoVGhlRW5jb3VudGVyLiJob3NwaXRhbGl6YXRpb25Mb2NhdGlvbnMiKCkpIEhvc3BpdGFsTG9jYXRpb24NCiAgCQkJc29ydCBieSBzdGFydCBvZiBwZXJpb2QNCiAgCSkucGVyaW9kDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgdGhlIGxhdGVzdCBkZXBhcnR1cmUgdGltZSBmb3IgZW5jb3VudGVyIGluY2x1ZGluZyBhbnkgcHJpb3IgRUQgdmlzaXQuDQpAZGVwcmVjYXRlZDogVGhpcyBmdW5jdGlvbiBpcyBkZXByZWNhdGVkLiBVc2UgdGhlIGZsdWVudCBmdW5jdGlvbiBgaG9zcGl0YWxEZXBhcnR1cmVUaW1lKClgIGluc3RlYWQuDQoqLw0KZGVmaW5lIGZ1bmN0aW9uICJIb3NwaXRhbCBEZXBhcnR1cmUgVGltZSIoVGhlRW5jb3VudGVyIEVuY291bnRlcik6DQoJZW5kIG9mIExhc3QoDQoJICAgICggIkhvc3BpdGFsaXphdGlvbiBMb2NhdGlvbnMiKFRoZUVuY291bnRlcikgKSBIb3NwaXRhbExvY2F0aW9uDQoJCQlzb3J0IGJ5IHN0YXJ0IG9mIHBlcmlvZA0KCSkucGVyaW9kDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgdGhlIGxhdGVzdCBkZXBhcnR1cmUgdGltZSBmb3IgZW5jb3VudGVyIGluY2x1ZGluZyBhbnkgcHJpb3IgRUQgdmlzaXQuDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBob3NwaXRhbERlcGFydHVyZVRpbWUoVGhlRW5jb3VudGVyIEVuY291bnRlcik6DQoJZW5kIG9mIExhc3QoDQoJICAgIChUaGVFbmNvdW50ZXIuImhvc3BpdGFsaXphdGlvbkxvY2F0aW9ucyIoKSkgSG9zcGl0YWxMb2NhdGlvbg0KCQkJc29ydCBieSBzdGFydCBvZiBwZXJpb2QNCgkpLnBlcmlvZA0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRoZSBlbWVyZ2VuY3kgZGVwYXJ0bWVudCBhcnJpdmFsIHRpbWUgZm9yIHRoZSBlbmNvdW50ZXIuDQpAZGVwcmVjYXRlZC4gVGhpcyBmdW5jdGlvbiBpcyBkZXByZWNhdGVkLiBVc2UgdGhlIGZsdWVudCBmdW5jdGlvbiBgZW1lcmdlbmN5RGVwYXJ0bWVudEFycml2YWxUaW1lKClgIGluc3RlYWQuDQoqLw0KZGVmaW5lIGZ1bmN0aW9uICJFbWVyZ2VuY3kgRGVwYXJ0bWVudCBBcnJpdmFsIFRpbWUiKFRoZUVuY291bnRlciBFbmNvdW50ZXIpOg0KCXN0YXJ0IG9mICgNCgkgICAgc2luZ2xldG9uIGZyb20gKA0KCSAgICAgICAgKCAiSG9zcGl0YWxpemF0aW9uIExvY2F0aW9ucyIoVGhlRW5jb3VudGVyKSApIEhvc3BpdGFsTG9jYXRpb24NCgkJCQl3aGVyZSBHZXRMb2NhdGlvbihIb3NwaXRhbExvY2F0aW9uLmxvY2F0aW9uKS50eXBlIGluICJFbWVyZ2VuY3kgRGVwYXJ0bWVudCBWaXNpdCINCgkJKQ0KCSkucGVyaW9kDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgdGhlIGVtZXJnZW5jeSBkZXBhcnRtZW50IGFycml2YWwgdGltZSBmb3IgdGhlIGVuY291bnRlci4NCiovDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGVtZXJnZW5jeURlcGFydG1lbnRBcnJpdmFsVGltZShUaGVFbmNvdW50ZXIgRW5jb3VudGVyKToNCglzdGFydCBvZiAoDQoJICAgIHNpbmdsZXRvbiBmcm9tICgNCgkgICAgICAgICggKFRoZUVuY291bnRlci4iaG9zcGl0YWxpemF0aW9uTG9jYXRpb25zIigpKSApIEhvc3BpdGFsTG9jYXRpb24NCgkJCQl3aGVyZSBHZXRMb2NhdGlvbihIb3NwaXRhbExvY2F0aW9uLmxvY2F0aW9uKS50eXBlIGluICJFbWVyZ2VuY3kgRGVwYXJ0bWVudCBWaXNpdCINCgkJKQ0KCSkucGVyaW9kDQoNCi8qDQpAZGVzY3JpcHRpb246IEhvc3BpdGFsaXphdGlvbiB3aXRoIE9ic2VydmF0aW9uIGFuZCBPdXRwYXRpZW50IFN1cmdlcnkgU2VydmljZSByZXR1cm5zIHRoZSB0b3RhbCBpbnRlcnZhbCBmcm9tIHRoZSBzdGFydCBvZiBhbnkgaW1tZWRpYXRlbHkgcHJpb3IgZW1lcmdlbmN5IGRlcGFydG1lbnQgdmlzaXQsIG91dHBhdGllbnQgc3VyZ2VyeSB2aXNpdCBvciBvYnNlcnZhdGlvbiB2aXNpdCB0byB0aGUgZGlzY2hhcmdlIG9mIHRoZSBnaXZlbiBlbmNvdW50ZXIuDQpAZGVwcmVjYXRlZDogVGhpcyBmdW5jdGlvbiBpcyBkZXByZWNhdGVkLiBVc2UgdGhlIGZsdWVudCBmdW5jdGlvbiBgaG9zcGl0YWxpemF0aW9uV2l0aE9ic2VydmF0aW9uQW5kT3V0cGF0aWVudFN1cmdlcnlTZXJ2aWNlKClgIGluc3RlYWQuDQoqLw0KZGVmaW5lIGZ1bmN0aW9uICJIb3NwaXRhbGl6YXRpb25XaXRoT2JzZXJ2YXRpb25BbmRPdXRwYXRpZW50U3VyZ2VyeVNlcnZpY2UiKFRoZUVuY291bnRlciAiRW5jb3VudGVyIiApOg0KICBUaGVFbmNvdW50ZXIgVmlzaXQNCgkgIGxldCBPYnNWaXNpdDogTGFzdChbRW5jb3VudGVyOiAiT2JzZXJ2YXRpb24gU2VydmljZXMiXSBMYXN0T2JzDQoJCSAgCXdoZXJlIExhc3RPYnMuc3RhdHVzID0gJ2ZpbmlzaGVkJw0KICAgICAgICAgIGFuZCBMYXN0T2JzLnBlcmlvZCBlbmRzIDEgaG91ciBvciBsZXNzIG9uIG9yIGJlZm9yZSBzdGFydCBvZiBWaXNpdC5wZXJpb2QNCgkJCSAgc29ydCBieQllbmQgb2YgcGVyaW9kDQogICAgCSksDQogICAgCVZpc2l0U3RhcnQ6IENvYWxlc2NlKHN0YXJ0IG9mIE9ic1Zpc2l0LnBlcmlvZCwgc3RhcnQgb2YgVmlzaXQucGVyaW9kKSwNCiAgICAJRURWaXNpdDogTGFzdChbRW5jb3VudGVyOiAiRW1lcmdlbmN5IERlcGFydG1lbnQgVmlzaXQiXSBMYXN0RUQNCgkJCSAgd2hlcmUgTGFzdEVELnN0YXR1cyA9ICdmaW5pc2hlZCcNCiAgICAgICAgICBhbmQgTGFzdEVELnBlcmlvZCBlbmRzIDEgaG91ciBvciBsZXNzIG9uIG9yIGJlZm9yZSBWaXNpdFN0YXJ0DQoJCQkgIHNvcnQgYnkJZW5kIG9mIHBlcmlvZA0KICAgIAkpLA0KICAgIAlWaXNpdFN0YXJ0V2l0aEVEOiBDb2FsZXNjZShzdGFydCBvZiBFRFZpc2l0LnBlcmlvZCwgVmlzaXRTdGFydCksDQogICAgCU91dHBhdGllbnRTdXJnZXJ5VmlzaXQ6IExhc3QoW0VuY291bnRlcjogIk91dHBhdGllbnQgU3VyZ2VyeSBTZXJ2aWNlIl0gTGFzdFN1cmdlcnlPUA0KCQkJICB3aGVyZSBMYXN0U3VyZ2VyeU9QLnBlcmlvZCBlbmRzIDEgaG91ciBvciBsZXNzIG9uIG9yIGJlZm9yZSBWaXNpdFN0YXJ0V2l0aEVEDQoJCQkgIHNvcnQgYnkJZW5kIG9mIHBlcmlvZA0KICAgIAkpDQogIAlyZXR1cm4gSW50ZXJ2YWxbQ29hbGVzY2Uoc3RhcnQgb2YgT3V0cGF0aWVudFN1cmdlcnlWaXNpdC5wZXJpb2QsIFZpc2l0U3RhcnRXaXRoRUQpLCBlbmQgb2YgVmlzaXQucGVyaW9kXQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBIb3NwaXRhbGl6YXRpb24gd2l0aCBPYnNlcnZhdGlvbiBhbmQgT3V0cGF0aWVudCBTdXJnZXJ5IFNlcnZpY2UgcmV0dXJucyB0aGUgdG90YWwgaW50ZXJ2YWwgZnJvbSB0aGUgc3RhcnQgb2YgYW55IGltbWVkaWF0ZWx5IHByaW9yIGVtZXJnZW5jeSBkZXBhcnRtZW50IHZpc2l0LCBvdXRwYXRpZW50IHN1cmdlcnkgdmlzaXQgb3Igb2JzZXJ2YXRpb24gdmlzaXQgdG8gdGhlIGRpc2NoYXJnZSBvZiB0aGUgZ2l2ZW4gZW5jb3VudGVyLg0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaG9zcGl0YWxpemF0aW9uV2l0aE9ic2VydmF0aW9uQW5kT3V0cGF0aWVudFN1cmdlcnlTZXJ2aWNlKFRoZUVuY291bnRlciAiRW5jb3VudGVyIiApOg0KICBUaGVFbmNvdW50ZXIgVmlzaXQNCgkgIGxldCBPYnNWaXNpdDogTGFzdChbRW5jb3VudGVyOiAiT2JzZXJ2YXRpb24gU2VydmljZXMiXSBMYXN0T2JzDQoJCSAgCXdoZXJlIExhc3RPYnMuc3RhdHVzID0gJ2ZpbmlzaGVkJw0KICAgICAgICAgIGFuZCBMYXN0T2JzLnBlcmlvZCBlbmRzIDEgaG91ciBvciBsZXNzIG9uIG9yIGJlZm9yZSBzdGFydCBvZiBWaXNpdC5wZXJpb2QNCgkJCSAgc29ydCBieQllbmQgb2YgcGVyaW9kDQogICAgCSksDQogICAgCVZpc2l0U3RhcnQ6IENvYWxlc2NlKHN0YXJ0IG9mIE9ic1Zpc2l0LnBlcmlvZCwgc3RhcnQgb2YgVmlzaXQucGVyaW9kKSwNCiAgICAJRURWaXNpdDogTGFzdChbRW5jb3VudGVyOiAiRW1lcmdlbmN5IERlcGFydG1lbnQgVmlzaXQiXSBMYXN0RUQNCgkJCSAgd2hlcmUgTGFzdEVELnN0YXR1cyA9ICdmaW5pc2hlZCcNCiAgICAgICAgICBhbmQgTGFzdEVELnBlcmlvZCBlbmRzIDEgaG91ciBvciBsZXNzIG9uIG9yIGJlZm9yZSBWaXNpdFN0YXJ0DQoJCQkgIHNvcnQgYnkJZW5kIG9mIHBlcmlvZA0KICAgIAkpLA0KICAgIAlWaXNpdFN0YXJ0V2l0aEVEOiBDb2FsZXNjZShzdGFydCBvZiBFRFZpc2l0LnBlcmlvZCwgVmlzaXRTdGFydCksDQogICAgCU91dHBhdGllbnRTdXJnZXJ5VmlzaXQ6IExhc3QoW0VuY291bnRlcjogIk91dHBhdGllbnQgU3VyZ2VyeSBTZXJ2aWNlIl0gTGFzdFN1cmdlcnlPUA0KCQkJICB3aGVyZSBMYXN0U3VyZ2VyeU9QLnBlcmlvZCBlbmRzIDEgaG91ciBvciBsZXNzIG9uIG9yIGJlZm9yZSBWaXNpdFN0YXJ0V2l0aEVEDQoJCQkgIHNvcnQgYnkJZW5kIG9mIHBlcmlvZA0KICAgIAkpDQogIAlyZXR1cm4gSW50ZXJ2YWxbQ29hbGVzY2Uoc3RhcnQgb2YgT3V0cGF0aWVudFN1cmdlcnlWaXNpdC5wZXJpb2QsIFZpc2l0U3RhcnRXaXRoRUQpLCBlbmQgb2YgVmlzaXQucGVyaW9kXQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBIb3NwaXRhbGl6YXRpb24gd2l0aCBPYnNlcnZhdGlvbiByZXR1cm5zIHRoZSB0b3RhbCBpbnRlcnZhbCBmcm9tIHRoZSBzdGFydCBvZiBhbnkgaW1tZWRpYXRlbHkgcHJpb3IgZW1lcmdlbmN5IGRlcGFydG1lbnQgdmlzaXQgdGhyb3VnaCB0aGUgb2JzZXJ2YXRpb24gdmlzaXQgdG8gdGhlIGRpc2NoYXJnZSBvZiB0aGUgZ2l2ZW4gZW5jb3VudGVyDQpAZGVwcmVjYXRlZDogVGhpcyBmdW5jdGlvbiBpcyBkZXByZWNhdGVkLiBVc2UgdGhlIGZsdWVudCBmdW5jdGlvbiBgaG9zcGl0YWxpemF0aW9uV2l0aE9ic2VydmF0aW9uKClgIGluc3RlYWQuDQoqLw0KZGVmaW5lIGZ1bmN0aW9uICJIb3NwaXRhbGl6YXRpb25XaXRoT2JzZXJ2YXRpb24iKFRoZUVuY291bnRlciBFbmNvdW50ZXIgKToNCiAgVGhlRW5jb3VudGVyIFZpc2l0DQogIAkJbGV0IE9ic1Zpc2l0OiBMYXN0KFtFbmNvdW50ZXI6ICJPYnNlcnZhdGlvbiBTZXJ2aWNlcyJdIExhc3RPYnMNCiAgCQkJCXdoZXJlIExhc3RPYnMuc3RhdHVzID0gJ2ZpbmlzaGVkJw0KICAgICAgICAgICAgYW5kIExhc3RPYnMucGVyaW9kIGVuZHMgMSBob3VyIG9yIGxlc3Mgb24gb3IgYmVmb3JlIHN0YXJ0IG9mIFZpc2l0LnBlcmlvZA0KICAJCQkJc29ydCBieSBlbmQgb2YgcGVyaW9kDQogIAkJCSksDQogIAkJCVZpc2l0U3RhcnQ6IENvYWxlc2NlKHN0YXJ0IG9mIE9ic1Zpc2l0LnBlcmlvZCwgc3RhcnQgb2YgVmlzaXQucGVyaW9kKSwNCiAgCQkJRURWaXNpdDogTGFzdChbRW5jb3VudGVyOiAiRW1lcmdlbmN5IERlcGFydG1lbnQgVmlzaXQiXSBMYXN0RUQNCiAgCQkJCXdoZXJlIExhc3RFRC5zdGF0dXMgPSAnZmluaXNoZWQnDQogICAgICAgICAgICBhbmQgTGFzdEVELnBlcmlvZCBlbmRzIDEgaG91ciBvciBsZXNzIG9uIG9yIGJlZm9yZSBWaXNpdFN0YXJ0DQogIAkJCQlzb3J0IGJ5IGVuZCBvZiBwZXJpb2QNCiAgCQkJKQ0KICAJCXJldHVybiBJbnRlcnZhbFtDb2FsZXNjZShzdGFydCBvZiBFRFZpc2l0LnBlcmlvZCwgVmlzaXRTdGFydCksIGVuZCBvZiBWaXNpdC5wZXJpb2RdDQoNCi8qDQpAZGVzY3JpcHRpb246IEhvc3BpdGFsaXphdGlvbiB3aXRoIE9ic2VydmF0aW9uIHJldHVybnMgdGhlIHRvdGFsIGludGVydmFsIGZyb20gdGhlIHN0YXJ0IG9mIGFueSBpbW1lZGlhdGVseSBwcmlvciBlbWVyZ2VuY3kgZGVwYXJ0bWVudCB2aXNpdCB0aHJvdWdoIHRoZSBvYnNlcnZhdGlvbiB2aXNpdCB0byB0aGUgZGlzY2hhcmdlIG9mIHRoZSBnaXZlbiBlbmNvdW50ZXINCiovDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGhvc3BpdGFsaXphdGlvbldpdGhPYnNlcnZhdGlvbihUaGVFbmNvdW50ZXIgRW5jb3VudGVyICk6DQogIFRoZUVuY291bnRlciBWaXNpdA0KICAJCWxldCBPYnNWaXNpdDogTGFzdChbRW5jb3VudGVyOiAiT2JzZXJ2YXRpb24gU2VydmljZXMiXSBMYXN0T2JzDQogIAkJCQl3aGVyZSBMYXN0T2JzLnN0YXR1cyA9ICdmaW5pc2hlZCcNCiAgICAgICAgICAgIGFuZCBMYXN0T2JzLnBlcmlvZCBlbmRzIDEgaG91ciBvciBsZXNzIG9uIG9yIGJlZm9yZSBzdGFydCBvZiBWaXNpdC5wZXJpb2QNCiAgCQkJCXNvcnQgYnkgZW5kIG9mIHBlcmlvZA0KICAJCQkpLA0KICAJCQlWaXNpdFN0YXJ0OiBDb2FsZXNjZShzdGFydCBvZiBPYnNWaXNpdC5wZXJpb2QsIHN0YXJ0IG9mIFZpc2l0LnBlcmlvZCksDQogIAkJCUVEVmlzaXQ6IExhc3QoW0VuY291bnRlcjogIkVtZXJnZW5jeSBEZXBhcnRtZW50IFZpc2l0Il0gTGFzdEVEDQogIAkJCQl3aGVyZSBMYXN0RUQuc3RhdHVzID0gJ2ZpbmlzaGVkJw0KICAgICAgICAgICAgYW5kIExhc3RFRC5wZXJpb2QgZW5kcyAxIGhvdXIgb3IgbGVzcyBvbiBvciBiZWZvcmUgVmlzaXRTdGFydA0KICAJCQkJc29ydCBieSBlbmQgb2YgcGVyaW9kDQogIAkJCSkNCiAgCQlyZXR1cm4gSW50ZXJ2YWxbQ29hbGVzY2Uoc3RhcnQgb2YgRURWaXNpdC5wZXJpb2QsIFZpc2l0U3RhcnQpLCBlbmQgb2YgVmlzaXQucGVyaW9kXQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBIb3NwaXRhbGl6YXRpb24gd2l0aCBPYnNlcnZhdGlvbiBMZW5ndGggb2YgU3RheSByZXR1cm5zIHRoZSBsZW5ndGggaW4gZGF5cyBmcm9tIHRoZSBzdGFydCBvZiBhbnkgaW1tZWRpYXRlbHkgcHJpb3IgZW1lcmdlbmN5IGRlcGFydG1lbnQgdmlzaXQgdGhyb3VnaCB0aGUgb2JzZXJ2YXRpb24gdmlzaXQgdG8gdGhlIGRpc2NoYXJnZSBvZiB0aGUgZ2l2ZW4gZW5jb3VudGVyDQpAZGVwcmVjYXRlZDogVGhpcyBmdW5jdGlvbiBpcyBkZXByZWNhdGVkLiBVc2UgdGhlIGZsdWVudCBmdW5jdGlvbiBgaG9zcGl0YWxpemF0aW9uV2l0aE9ic2VydmF0aW9uTGVuZ3Rob2ZTdGF5KClgIGluc3RlYWQuDQoqLw0KZGVmaW5lIGZ1bmN0aW9uICJIb3NwaXRhbGl6YXRpb25XaXRoT2JzZXJ2YXRpb25MZW5ndGhvZlN0YXkiKFRoZUVuY291bnRlciAiRW5jb3VudGVyIiApOg0KICAiTGVuZ3RoSW5EYXlzIigiSG9zcGl0YWxpemF0aW9uV2l0aE9ic2VydmF0aW9uIihUaGVFbmNvdW50ZXIpKQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBIb3NwaXRhbGl6YXRpb24gd2l0aCBPYnNlcnZhdGlvbiBMZW5ndGggb2YgU3RheSByZXR1cm5zIHRoZSBsZW5ndGggaW4gZGF5cyBmcm9tIHRoZSBzdGFydCBvZiBhbnkgaW1tZWRpYXRlbHkgcHJpb3IgZW1lcmdlbmN5IGRlcGFydG1lbnQgdmlzaXQgdGhyb3VnaCB0aGUgb2JzZXJ2YXRpb24gdmlzaXQgdG8gdGhlIGRpc2NoYXJnZSBvZiB0aGUgZ2l2ZW4gZW5jb3VudGVyDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBob3NwaXRhbGl6YXRpb25XaXRoT2JzZXJ2YXRpb25MZW5ndGhvZlN0YXkoVGhlRW5jb3VudGVyICJFbmNvdW50ZXIiICk6DQogICgoVGhlRW5jb3VudGVyLiJob3NwaXRhbGl6YXRpb25XaXRoT2JzZXJ2YXRpb24iKCkuImxlbmd0aEluRGF5cyIoKSkpDQoNCi8qDQpAZGVzY3JpcHRpb246IEZpcnN0IElucGF0aWVudCBJbnRlbnNpdmUgQ2FyZSBVbml0IHJldHVybnMgdGhlIGZpcnN0IGludGVuc2l2ZSBjYXJlIHVuaXQgZm9yIHRoZSBnaXZlbiBlbmNvdW50ZXIsIHdpdGhvdXQgY29uc2lkZXJpbmcgYW55IGltbWVkaWF0ZWx5IHByaW9yIGVtZXJnZW5jeSBkZXBhcnRtZW50IHZpc2l0Lg0KQGRlcHJlY2F0ZWQ6IFRoaXMgZnVuY3Rpb24gaXMgZGVwcmVjYXRlZC4gVXNlIHRoZSBmbHVlbnQgZnVuY3Rpb24gYGZpcnN0SW5wYXRpZW50SW50ZW5zaXZlQ2FyZVVuaXQoKWAgaW5zdGVhZC4NCiovDQpkZWZpbmUgZnVuY3Rpb24gIkZpcnN0SW5wYXRpZW50SW50ZW5zaXZlQ2FyZVVuaXQiKEVuY291bnRlciBFbmNvdW50ZXIgKToNCiAgRmlyc3QoKEVuY291bnRlci5sb2NhdGlvbilIb3NwaXRhbExvY2F0aW9uDQogIAkJCXdoZXJlIEdldExvY2F0aW9uKEhvc3BpdGFsTG9jYXRpb24ubG9jYXRpb24pLnR5cGUgaW4gIkludGVuc2l2ZSBDYXJlIFVuaXQiDQogIAkJCQlhbmQgSG9zcGl0YWxMb2NhdGlvbi5wZXJpb2QgZHVyaW5nIEVuY291bnRlci5wZXJpb2QNCiAgCQkJc29ydCBieSBzdGFydCBvZiBwZXJpb2QNCiAgCSkNCg0KLyoNCkBkZXNjcmlwdGlvbjogRmlyc3QgSW5wYXRpZW50IEludGVuc2l2ZSBDYXJlIFVuaXQgcmV0dXJucyB0aGUgZmlyc3QgaW50ZW5zaXZlIGNhcmUgdW5pdCBmb3IgdGhlIGdpdmVuIGVuY291bnRlciwgd2l0aG91dCBjb25zaWRlcmluZyBhbnkgaW1tZWRpYXRlbHkgcHJpb3IgZW1lcmdlbmN5IGRlcGFydG1lbnQgdmlzaXQuDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBmaXJzdElucGF0aWVudEludGVuc2l2ZUNhcmVVbml0KEVuY291bnRlciBFbmNvdW50ZXIgKToNCiAgRmlyc3QoKEVuY291bnRlci5sb2NhdGlvbilIb3NwaXRhbExvY2F0aW9uDQogIAkJCXdoZXJlIEdldExvY2F0aW9uKEhvc3BpdGFsTG9jYXRpb24ubG9jYXRpb24pLnR5cGUgaW4gIkludGVuc2l2ZSBDYXJlIFVuaXQiDQogIAkJCQlhbmQgSG9zcGl0YWxMb2NhdGlvbi5wZXJpb2QgZHVyaW5nIEVuY291bnRlci5wZXJpb2QNCiAgCQkJc29ydCBieSBzdGFydCBvZiBwZXJpb2QNCiAgCSkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0aGUgQ29uZGl0aW9uIHJlc291cmNlIHJlZmVyZW5jZWQgYnkgdGhlIGBkaWFnbm9zaXMuY29uZGl0aW9uYCBlbGVtZW50IG9mIHRoZSBFbmNvdW50ZXINCkBkZXByZWNhdGVkOiBUaGlzIGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQuIFVzZSB0aGUgZmx1ZW50IGZ1bmN0aW9uIGBlbmNvdW50ZXJEaWFnbm9zaXMoKWAgaW5zdGVhZC4NCiovDQpkZWZpbmUgZnVuY3Rpb24gIkVuY291bnRlckRpYWdub3NpcyIoRW5jb3VudGVyIEVuY291bnRlciApOg0KICBFbmNvdW50ZXIuZGlhZ25vc2lzIEQNCglyZXR1cm4gc2luZ2xldG9uIGZyb20gKChbQ29uZGl0aW9uRW5jb3VudGVyRGlhZ25vc2lzXSB1bmlvbiBbQ29uZGl0aW9uUHJvYmxlbXNIZWFsdGhDb25jZXJuc10pIEMgd2hlcmUgRC5jb25kaXRpb24ucmVmZXJlbmNlcyhDLmlkKSkNCg0KLyogIA0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRoZSBDb25kaXRpb24gcmVzb3VyY2VzIHJlZmVyZW5jZWQgYnkgdGhlIGRpYWdub3NpcyBlbGVtZW50IG9mIHRoZSBFbmNvdW50ZXIgIA0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gZW5jb3VudGVyRGlhZ25vc2lzKEVuY291bnRlciBFbmNvdW50ZXIgKToNCiAgRW5jb3VudGVyLnJlYXNvblJlZmVyZW5jZSBEDQogICAgcmV0dXJuIHNpbmdsZXRvbiBmcm9tICgoW0NvbmRpdGlvbkVuY291bnRlckRpYWdub3Npc10gdW5pb24gW0NvbmRpdGlvblByb2JsZW1zSGVhbHRoQ29uY2VybnNdKSBDIHdoZXJlIEQucmVmZXJlbmNlcyhDLmlkKSkNCg0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRoZSBDb25kaXRpb24gcmVzb3VyY2UgZm9yIHRoZSBnaXZlbiByZWZlcmVuY2UNCkBkZXByZWNhdGVkOiBUaGlzIGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQuIFVzZSB0aGUgZmx1ZW50IGZ1bmN0aW9uIGBnZXRDb25kaXRpb24oKWAgaW5zdGVhZA0KKi8NCmRlZmluZSBmdW5jdGlvbiAiR2V0Q29uZGl0aW9uIihyZWZlcmVuY2UgUmVmZXJlbmNlKToNCiAgc2luZ2xldG9uIGZyb20gKChbQ29uZGl0aW9uRW5jb3VudGVyRGlhZ25vc2lzXSB1bmlvbiBbQ29uZGl0aW9uUHJvYmxlbXNIZWFsdGhDb25jZXJuc10pIEMgd2hlcmUgcmVmZXJlbmNlLnJlZmVyZW5jZXMoQy5pZCkpDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgdGhlIENvbmRpdGlvbiByZXNvdXJjZSBmb3IgdGhlIGdpdmVuIHJlZmVyZW5jZQ0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gZ2V0Q29uZGl0aW9uKHJlZmVyZW5jZSBSZWZlcmVuY2UpOg0KICBzaW5nbGV0b24gZnJvbSAoKFtDb25kaXRpb25FbmNvdW50ZXJEaWFnbm9zaXNdIHVuaW9uIFtDb25kaXRpb25Qcm9ibGVtc0hlYWx0aENvbmNlcm5zXSkgQyB3aGVyZSByZWZlcmVuY2UucmVmZXJlbmNlcyhDLmlkKSkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0aGUgY29uZGl0aW9uIHRoYXQgaXMgc3BlY2lmaWVkIGFzIHRoZSBwcmluY2lwYWwgZGlhZ25vc2lzIGZvciB0aGUgZW5jb3VudGVyDQpAZGVwcmVjYXRlZDogVGhpcyBmdW5jdGlvbiBpcyBkZXByZWNhdGVkLiBVc2UgdGhlIGZsdWVudCBmdW5jdGlvbiBgcHJpbmNpcGFsRGlhZ25vc2lzKClgIGluc3RlYWQuDQoqLw0KZGVmaW5lIGZ1bmN0aW9uICJQcmluY2lwYWxEaWFnbm9zaXMiKEVuY291bnRlciBFbmNvdW50ZXIpOg0KCXNpbmdsZXRvbiBmcm9tICgNCgkoRW5jb3VudGVyLmRpYWdub3NpcyBEIHdoZXJlIEQucmFuayA9IDEgYW5kIEQudXNlIH4gIkJpbGxpbmciKSBQRA0KICAgICAgcmV0dXJuIHNpbmdsZXRvbiBmcm9tICgoW0NvbmRpdGlvbkVuY291bnRlckRpYWdub3Npc10gdW5pb24gW0NvbmRpdGlvblByb2JsZW1zSGVhbHRoQ29uY2VybnNdKSBDIHdoZXJlIFBELmNvbmRpdGlvbi5yZWZlcmVuY2VzKEMuaWQpKQ0KCSkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0aGUgY2xhaW0gZGlhZ25vc2lzIGVsZW1lbnQgdGhhdCBpcyBzcGVjaWZpZWQgYXMgdGhlIHByaW5jaXBhbCBkaWFnbm9zaXMgZm9yIHRoZSBlbmNvdW50ZXINCiBAY29tbWVudDogU2VlIHRoZSBRSUNvcmUgNiBBdXRob3JpbmcgUGF0dGVybnMgZGlzY3Vzc2lvbiBvbiBbUHJpbmNpcGFsIERpYWdub3NpcyBhbmQgUHJlc2VudCBvbiBBZG1pc3Npb25dKGh0dHBzOi8vZ2l0aHViLmNvbS9jcWZyYW1ld29yay9DUUwtRm9ybWF0dGluZy1hbmQtVXNhZ2UtV2lraS93aWtpL0F1dGhvcmluZy1QYXR0ZXJucy1RSUNvcmUtdjYuMC4wI2NvbmRpdGlvbnMtcHJlc2VudC1vbi1hZG1pc3Npb24tYW5kLXByaW5jaXBhbC1kaWFnbm9zZXMpIGZvciBtb3JlIGluZm9ybWF0aW9uDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBwcmluY2lwYWxEaWFnbm9zaXMoZW5jb3VudGVyIEVuY291bnRlcik6DQpzaW5nbGV0b24gZnJvbSAoDQogICAgIChlbmNvdW50ZXIuY2xhaW1EaWFnbm9zaXMoKSkgQ0QNCiAgICAgICB3aGVyZSBDRC50eXBlLmluY2x1ZGVzQ29kZSgiUHJpbmNpcGFsIERpYWdub3NpcyIpDQogICApDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRoZSBjbGFpbSBkaWFnbm9zaXMgZWxlbWVudHMgZm9yIHRoZSBnaXZlbiBlbmNvdW50ZXINCkBjb21tZW50OiBTZWUgdGhlIFFJQ29yZSA2IEF1dGhvcmluZyBQYXR0ZXJucyBkaXNjdXNzaW9uIG9uIFtQcmluY2lwYWwgRGlhZ25vc2lzIGFuZCBQcmVzZW50IG9uIEFkbWlzc2lvbl0oaHR0cHM6Ly9naXRodWIuY29tL2NxZnJhbWV3b3JrL0NRTC1Gb3JtYXR0aW5nLWFuZC1Vc2FnZS1XaWtpL3dpa2kvQXV0aG9yaW5nLVBhdHRlcm5zLVFJQ29yZS12Ni4wLjAjY29uZGl0aW9ucy1wcmVzZW50LW9uLWFkbWlzc2lvbi1hbmQtcHJpbmNpcGFsLWRpYWdub3NlcykgZm9yIG1vcmUgaW5mb3JtYXRpb24NCiovDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGNsYWltRGlhZ25vc2lzKGVuY291bnRlciBFbmNvdW50ZXIpOg0KICBlbmNvdW50ZXIgRQ0KICAgIGxldCANCiAgICAgIGNsYWltOiAoW0NsYWltXSBDIHdoZXJlIEMuc3RhdHVzID0gJ2FjdGl2ZScgYW5kIEMudXNlID0gJ2NsYWltJyBhbmQgZXhpc3RzIChDLml0ZW0gSSB3aGVyZSBJLmVuY291bnRlci5yZWZlcmVuY2VzKEUpKSksDQogICAgICBjbGFpbUl0ZW06IChjbGFpbS5pdGVtIEkgd2hlcmUgSS5lbmNvdW50ZXIucmVmZXJlbmNlcyhFKSkNCiAgICByZXR1cm4gY2xhaW0uZGlhZ25vc2lzIEQgd2hlcmUgRC5zZXF1ZW5jZSBpbiBjbGFpbUl0ZW0uZGlhZ25vc2lzU2VxdWVuY2UNCg0KDQovKg0KIEBkZXNjcmlwdGlvbjogUmV0dXJucyB0aGUgY29uZGl0aW9uIHRoYXQgaXMgc3BlY2lmaWVkIGFzIHRoZSBwcmluY2lwYWwgZGlhZ25vc2lzIGZvciB0aGUgZW5jb3VudGVyIGFuZCBoYXMgYSBjb2RlIGluIHRoZSBnaXZlbiB2YWx1ZVNldC4NCiBAY29tbWVudDogU2VlIHRoZSBRSUNvcmUgNiBBdXRob3JpbmcgUGF0dGVybnMgZGlzY3Vzc2lvbiBvbiBbUHJpbmNpcGFsIERpYWdub3NpcyBhbmQgUHJlc2VudCBvbiBBZG1pc3Npb25dKGh0dHBzOi8vZ2l0aHViLmNvbS9jcWZyYW1ld29yay9DUUwtRm9ybWF0dGluZy1hbmQtVXNhZ2UtV2lraS93aWtpL0F1dGhvcmluZy1QYXR0ZXJucy1RSUNvcmUtdjYuMC4wI2NvbmRpdGlvbnMtcHJlc2VudC1vbi1hZG1pc3Npb24tYW5kLXByaW5jaXBhbC1kaWFnbm9zZXMpIGZvciBtb3JlIGluZm9ybWF0aW9uDQogKi8NCiBkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIGhhc1ByaW5jaXBhbERpYWdub3Npc09mKGVuY291bnRlciBFbmNvdW50ZXIsIHZhbHVlU2V0IFZhbHVlU2V0KToNCiAgIChlbmNvdW50ZXIucHJpbmNpcGFsRGlhZ25vc2lzKCkpIFBEDQogICAgIHJldHVybiBQRC5kaWFnbm9zaXMgaW4gdmFsdWVTZXQNCiAgICAgICBvciBQRC5kaWFnbm9zaXMuZ2V0Q29uZGl0aW9uKCkuY29kZSBpbiB2YWx1ZVNldA0KDQovKg0KIEBkZXNjcmlwdGlvbjogUmV0dXJucyB0cnVlIGlmIHRoZSBnaXZlbiBkaWFnbm9zaXMgaXMgcHJlc2VudCBvbiBhZG1pc3Npb24sIGJhc2VkIG9uIHRoZSBnaXZlbiBwb2FWYWx1ZVNldA0KIEBjb21tZW50OiBTZWUgdGhlIFFJQ29yZSA2IEF1dGhvcmluZyBQYXR0ZXJucyBkaXNjdXNzaW9uIG9uIFtQcmluY2lwYWwgRGlhZ25vc2lzIGFuZCBQcmVzZW50IG9uIEFkbWlzc2lvbl0oaHR0cHM6Ly9naXRodWIuY29tL2NxZnJhbWV3b3JrL0NRTC1Gb3JtYXR0aW5nLWFuZC1Vc2FnZS1XaWtpL3dpa2kvQXV0aG9yaW5nLVBhdHRlcm5zLVFJQ29yZS12Ni4wLjAjY29uZGl0aW9ucy1wcmVzZW50LW9uLWFkbWlzc2lvbi1hbmQtcHJpbmNpcGFsLWRpYWdub3NlcykgZm9yIG1vcmUgaW5mb3JtYXRpb24NCiAqLw0KIGRlZmluZSBmbHVlbnQgZnVuY3Rpb24gaXNEaWFnbm9zaXNQcmVzZW50T25BZG1pc3Npb24oZW5jb3VudGVyIEVuY291bnRlciwgZGlhZ25vc2lzVmFsdWVTZXQgVmFsdWVTZXQsIHBvYVZhbHVlU2V0IFZhbHVlU2V0KToNCiAgIGV4aXN0cyAoDQogICAgIChlbmNvdW50ZXIuY2xhaW1EaWFnbm9zaXMoKSkgQ0QNCiAgICAgICB3aGVyZSBDRC5vbkFkbWlzc2lvbiBpbiBwb2FWYWx1ZVNldA0KICAgICAgICAgYW5kICgNCiAgICAgICAgICAgQ0QuZGlhZ25vc2lzIGluIGRpYWdub3Npc1ZhbHVlU2V0DQogICAgICAgICAgICAgb3IgQ0QuZGlhZ25vc2lzLmdldENvbmRpdGlvbigpLmNvZGUgaW4gZGlhZ25vc2lzVmFsdWVTZXQNCiAgICAgICAgICkNCiAgICkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0aGUgTG9jYXRpb24gcmVzb3VyY2Ugc3BlY2lmaWVkIGJ5IHRoZSBnaXZlbiByZWZlcmVuY2UNCkBkZXByZWNhdGVkOiBUaGlzIGZ1bmN0aW9uIGlzIGRlcHJlY2F0ZWQuIFVzZSB0aGUgZmx1ZW50IGZ1bmN0aW9uIGBnZXRMb2NhdGlvbigpYCBpbnN0ZWFkLg0KKi8NCmRlZmluZSBmdW5jdGlvbiAiR2V0TG9jYXRpb24iKHJlZmVyZW5jZSBSZWZlcmVuY2UpOg0KICBzaW5nbGV0b24gZnJvbSAoDQogICAgW0xvY2F0aW9uXSBMIHdoZXJlIHJlZmVyZW5jZS5yZWZlcmVuY2VzKEwpDQogICkNCg0KLyoNCkBkZXNjcmlwdGlvbjogUmV0dXJucyB0aGUgTG9jYXRpb24gcmVzb3VyY2Ugc3BlY2lmaWVkIGJ5IHRoZSBnaXZlbiByZWZlcmVuY2UuDQoqLw0KZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBnZXRMb2NhdGlvbihyZWZlcmVuY2UgUmVmZXJlbmNlKToNCiAgc2luZ2xldG9uIGZyb20gKA0KICAgIFtMb2NhdGlvbl0gTCB3aGVyZSByZWZlcmVuY2UucmVmZXJlbmNlcyhMKQ0KICApDQoNCi8qDQpAZGVzY3JpcHRpb246IFJldHVybnMgdGhlIG1lZGljYXRpb24gY29kZSBmb3IgdGhlIGdpdmVuIE1lZGljYXRpb25SZXF1ZXN0DQpAZGVwcmVjYXRlZDogVGhpcyBmdW5jdGlvbiBpcyBkZXByZWNhdGVkLiBVc2UgdGhlIGZsdWVudCBmdW5jdGlvbiBgZ2V0TWVkaWNhdGlvbkNvZGUoKWAgaW5zdGVhZC4NCiovDQpkZWZpbmUgZnVuY3Rpb24gIkdldE1lZGljYXRpb25Db2RlIihyZXF1ZXN0IE1lZGljYXRpb25SZXF1ZXN0KToNCiAgaWYgcmVxdWVzdC5tZWRpY2F0aW9uIGlzIENvbmNlcHQgdGhlbg0KICAJICByZXF1ZXN0Lm1lZGljYXRpb24gYXMgQ29uY2VwdA0KICAJZWxzZQ0KICAJICAoc2luZ2xldG9uIGZyb20gKFtNZWRpY2F0aW9uXSBNIHdoZXJlIHJlcXVlc3QubWVkaWNhdGlvbi5yZWZlcmVuY2VzKE0pKSkuY29kZQ0KDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRoZSBtZWRpY2F0aW9uIGNvZGUgZm9yIHRoZSBnaXZlbiBNZWRpY2F0aW9uUmVxdWVzdA0KKi8NCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gZ2V0TWVkaWNhdGlvbkNvZGUocmVxdWVzdCBNZWRpY2F0aW9uUmVxdWVzdCk6DQogIGlmIHJlcXVlc3QubWVkaWNhdGlvbiBpcyBDb25jZXB0IHRoZW4NCiAgCSAgcmVxdWVzdC5tZWRpY2F0aW9uIGFzIENvbmNlcHQNCiAgCWVsc2UNCiAgCSAgKHNpbmdsZXRvbiBmcm9tIChbTWVkaWNhdGlvbl0gTSB3aGVyZSByZXF1ZXN0Lm1lZGljYXRpb24ucmVmZXJlbmNlcyhNKSkpLmNvZGUNCiAgCSAgDQovKg0KQGRlc2NyaXB0aW9uOiBSZXR1cm5zIHRoZSBjbGFpbSBwcm9jZWR1cmUgZWxlbWVudHMgZm9yIHRoZSBnaXZlbiBlbmNvdW50ZXINCiovDQpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIHByaW5jaXBhbFByb2NlZHVyZShlbmNvdW50ZXIgRW5jb3VudGVyKTogIAkgIA0KICAJIGVuY291bnRlciBFDQogIAkgbGV0IA0KICAgICAgICBjbGFpbTogW0NsYWltXSBDIHdoZXJlIEMuc3RhdHVzID0gJ2FjdGl2ZScgYW5kIEMudXNlID0gJ2NsYWltJyBhbmQgZXhpc3RzIChDLml0ZW0gSSB3aGVyZSBJLmVuY291bnRlci5yZWZlcmVuY2VzKEUpKSwNCiAgICAgICAgY2xhaW1JdGVtOiBjbGFpbS5pdGVtIEkgd2hlcmUgSS5lbmNvdW50ZXIucmVmZXJlbmNlcyhFKSwNCiAgICAgICAgcHJpbmNQcm9jZWR1cmU6IHNpbmdsZXRvbiBmcm9tIChjbGFpbS5wcm9jZWR1cmUgUCB3aGVyZSBQLnNlcXVlbmNlIGluIGNsYWltSXRlbS5wcm9jZWR1cmVTZXF1ZW5jZSBhbmQgUC50eXBlLmluY2x1ZGVzQ29kZSgiUHJpbWFyeSBwcm9jZWR1cmUiKSkNCiAgICByZXR1cm4gcHJpbmNQcm9jZWR1cmU=",
    "url": "https://madie.cms.gov/Library-CQMCommon.cql"
  } ]
}